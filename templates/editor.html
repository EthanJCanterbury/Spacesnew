{% extends "base.html" %}

{% block body_class %}editor-page{% endblock %}

{% block head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/eclipse.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/matchesonscrollbar.min.css">

<link rel="stylesheet" href="{{ url_for('static', filename='css/editor.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/github.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/hackatime-badge.css') }}">
{% endblock %}

{% block content %}
<div id="loading-overlay" class="loading-overlay">
    <div class="particles-container" id="particles-js"></div>
    <div class="loading-content">
        <div class="loading-spinner-container">
            <div class="loading-spinner"></div>
            <div class="loading-spinner-shadow"></div>
        </div>
        <div class="loading-text-container">
            <p class="loading-text">Building Your Space :D</p>
        </div>
        <div class="loading-progress-container">
            <div class="loading-progress-bar">
                <div class="loading-progress-fill"></div>
            </div>
        </div>
        <div class="loading-facts">
            <div class="fact-container">
                <p class="loading-fact">Building your digital canvas...</p>
            </div>
        </div>
    </div>
    <div class="loading-glow"></div>
    <div class="loading-corners">
        <div class="corner top-left"></div>
        <div class="corner top-right"></div>
        <div class="corner bottom-left"></div>
        <div class="corner bottom-right"></div>
    </div>
</div>
<div class="editor-container split-layout">
    <div class="editor-topbar">
        <div class="topbar-left">
            <a href="{{ url_for('welcome') }}" class="btn-icon" title="Back to Dashboard">
                <i class="fas fa-arrow-left"></i>
            </a>
            <h1>{{ site.name }}</h1>
        </div>
        <div class="topbar-actions">
            <button id="undoBtn" class="btn-icon" title="Undo (Ctrl+Z)" disabled>
                <i class="fas fa-undo"></i>
            </button>
            <button id="redoBtn" class="btn-icon" title="Redo (Ctrl+Y)" disabled>
                <i class="fas fa-redo"></i>
            </button>

            <div class="dropdown">
                <button class="btn-icon dropdown-toggle" title="Editor Settings">
                    <i class="fas fa-cog"></i>
                </button>
                <div class="dropdown-menu">
                    <div class="dropdown-section">
                        <label for="themeSelector">Theme:</label>
                        <select id="themeSelector" onchange="changeEditorTheme(this.value)">
                            <option value="eclipse">Eclipse</option>
                            <option value="monokai">Monokai</option>
                            <option value="dracula">Dracula</option>
                            <option value="material">Material</option>
                            <option value="mdn-like">MDN-like</option>
                            <option value="solarized dark">Solarized Dark</option>
                            <option value="solarized light">Solarized Light</option>
                        </select>
                    </div>
                    <div class="dropdown-section">
                        <label for="fontSizeSelector">Font Size:</label>
                        <select id="fontSizeSelector" onchange="changeEditorFontSize(this.value)">
                            <option value="12px">Small</option>
                            <option value="14px" selected>Medium</option>
                            <option value="16px">Large</option>
                            <option value="18px">X-Large</option>
                        </select>
                    </div>
                    <div class="dropdown-section checkbox">
                        <label>
                            <input type="checkbox" id="wordWrapToggle" checked onchange="toggleWordWrap(this.checked)">
                            Word Wrap
                        </label>
                    </div>
                    <div class="dropdown-section checkbox">
                        <label>
                            <input type="checkbox" id="lintToggle" onchange="toggleLinting(this.checked)">
                            Lint Code
                        </label>
                    </div>
                </div>
            </div>

            <button id="searchBtn" class="btn-icon" title="Search (Ctrl+F)" onclick="focusSearch()">
                <i class="fas fa-search"></i>
            </button>

            {% if site.site_type == 'web' %}
            <button id="tutorialBtn" class="btn-primary" onclick="openTutorialModal()" style="background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);">
                <i class="fas fa-graduation-cap"></i>
                Tutorial
            </button>
            <button id="yswsBtn" class="btn-primary" onclick="openYSWSModal()">
                <i class="fa-solid fa-gift"></i>
                YSWS
            </button>
            <button id="analyticsBtn" class="btn-primary" onclick="openModal('analyticsModal')">
                <i class="fas fa-chart-line"></i>
                Analytics
            </button>
            <button id="orphyBtn" class="btn-primary" onclick="openOrphyChat()">
                <i class="fas fa-magic"></i>
                Orphy
            </button>
            {% elif site.site_type == 'python' %}
            <button id="runBtn" class="btn-primary" onclick="runCode()">
                <i class="fas fa-play"></i>
                Run
            </button>
            <button id="formatterBtn" class="btn-primary" onclick="formatCode()">
                <i class="fas fa-magic"></i>
                Format
            </button>
            {% endif %}

            <button id="saveBtn" class="btn-primary" onclick="saveContent()">
                <i class="fas fa-save"></i>
                Save Changes
            </button>

            <button id="gitBtn" class="btn-primary" onclick="GitHubManager.openModal()" style="background: linear-gradient(135deg, #fa8072 0%, #e57363 100%);">
                <i class="fab fa-github"></i>
                Git
            </button>
        </div>
    </div>
    <div class="editor-main">
        <div class="editor-pane">
            {% if site.site_type == 'web' %}
            <div class="file-tabs">
                <button class="file-tab active" data-filename="index.html" data-filetype="html">index.html</button>
                <button class="file-tab" data-filename="styles.css" data-filetype="css">styles.css</button>
                <button class="file-tab" data-filename="script.js" data-filetype="js">script.js</button>
                <button class="file-tab-add" title="Add new file" id="addFileBtn">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
            <div id="new-file-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Create New File</h2>
                        <button class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="newFilename">Filename (include extension):</label>
                            <input type="text" id="newFilename" placeholder="e.g., about.html, styles.css, script.js">
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button class="btn-secondary" id="cancelNewFile">Cancel</button>
                        <button class="btn-primary" id="createNewFile">Create</button>
                    </div>
                </div>
            </div>
            {% endif %}
            <textarea id="editor">{{ site.html_content }}</textarea>
            <input type="hidden" id="site-slug" value="{{ site.slug }}">
            <input type="hidden" id="site-id" value="{{ site.id }}">
            <input type="hidden" id="site-type" value="{{ site.site_type }}">
            <div class="editor-statusbar">
                <div class="status-section">
                    <div class="status-item" id="cursorPosition">
                        <i class="fas fa-map-marker-alt"></i> Line 1, Column 1
                    </div>
                    <div class="status-item" id="fileSizeInfo">
                        <i class="fas fa-file-alt"></i> <span id="fileSize">0</span> bytes
                    </div>
                </div>
                <div class="status-section">
                    <div class="status-item" id="editorMode">
                        {{ site.site_type|upper }}
                    </div>
                    <div class="status-item" id="editorSettings">
                        <i class="fas fa-keyboard"></i>
                        <a href="#" onclick="showKeyboardShortcutsModal(); return false;">Shortcuts</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="preview-pane">
            {% if site.site_type == 'web' %}
            <div class="browser-frame">
                <div class="browser-header">
                    <div class="browser-address" style="display: flex; align-items: center; width: 100%;">
                        <div style="flex: 1"></div>
                        <div style="display: flex; align-items: center; position: absolute; left: 50%; transform: translateX(-50%); z-index: 10000;">
                            <i class="fas fa-lock"></i>
                            <span class="browser-url">https://hackclub.space/s/{{ site.slug|default('', true) }}</span>
                            <button id="openDeployedSiteBtn" class="btn-icon" title="Open deployed site in new tab" onclick="openDeployedSite()" style="z-index: 10000;">
                                <i class="fas fa-external-link-alt"></i>
                            </button>
                        </div>
                        <div style="flex: 1; display: flex; justify-content: flex-end; gap: 8px; z-index: 2; position: relative;">
                            <button id="deployBtn" title="Deploy your site" onclick="deploySite()">
                                <i class="fas fa-rocket" style="color: white;"></i> Deploy
                            </button>
                            <button id="runBtn" title="Run your code" onclick="saveContent()" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); color: white; border: none; border-radius: 4px; padding: 5px 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease;">
                                <i class="fas fa-play" style="color: white;"></i> Run
                            </button>
                        </div>
                    </div>
                </div>
                <iframe id="preview" frameborder="0"></iframe>
            </div>
            {% elif site.site_type == 'python' %}
            <div class="console-frame">
                <div class="console-header">
                    <div class="console-title">
                        <i class="fas fa-terminal"></i>
                        Output Console
                    </div>
                </div>
                <pre id="output" class="console-output">Run your code to see the output here!</pre>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<div id="toast-container"></div>

<div id="githubModal" class="modal" style="display: none; opacity: 1; visibility: visible;">
    <div class="github-modal-content">
        <div class="github-modal-header">
            <h2><i class="fab fa-github"></i> GitHub Integration</h2>
            <button class="close-btn" onclick="GitHubManager.closeModal()">&times;</button>
        </div>
        <div class="github-modal-body" id="githubModalBody">
            <!-- Content will be dynamically loaded by GitHubManager -->
        </div>
    </div>
</div>

{% if site.site_type == 'web' %}
<div id="analyticsModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Site Analytics</h2>
            <button class="close-btn" onclick="closeModal('analyticsModal')">&times;</button>
        </div>
        <div class="modal-body">
            <div class="analytics-summary">
                <div class="analytics-count">
                    <span>1234</span>
                    <label>Total Views</label>
                </div>
                <div class="analytics-actions">
                    <div class="analytics-toggle">
                        <label for="analytics-toggle">Enable Analytics:</label>
                        <label class="switch">
                            <input type="checkbox" id="analytics-toggle">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <button id="clearAnalyticsBtn" class="btn-danger">
                        <i class="fas fa-trash"></i>
                        Clear Analytics
                    </button>
                </div>
            </div>
            <div class="analytics-info">
                <p><i class="fas fa-info-circle"></i> View count shows total visits to your site.</p>
            </div>
        </div>
    </div>
</div>
{% endif %}

<div id="deployModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-rocket"></i> Deploy Your Site</h2>
            <button class="close-btn" onclick="closeDeployModal()">&times;</button>
        </div>
        <div class="modal-body">
            <p>Your site is available at the following URLs:</p>
            <div id="deployUrlsContainer">
                {% set siteSlug = site.slug %}
                {% set defaultDomain = 'hackclub.space' %}
                {% set domains = ['hackclub.space', 'imahacker.lol', 'myhack.club', 'hackclub.me'] %}

                {% for domain in domains %}
                    {% set url = 'https://' + domain + '/s/' + siteSlug %}
                    <div class="site-url">
                        <input type="text" value="{{ url }}" readonly>
                        <button onclick="navigator.clipboard.writeText('{{ url }}')" class="btn-copy">Copy</button>
                        <a href="{{ url }}" target="_blank" class="btn-icon" title="Open in new tab">
                            <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                {% endfor %}
            </div>
            <div class="modal-info">
                <p><strong>Note:</strong> Your default domain is <code>https://{{ defaultDomain }}/s/{{ siteSlug }}</code></p>
                {% if request.host == 'spaces.hackclub.com' %}
                    <p><strong>Warning:</strong> Public hosting is not available on spaces.hackclub.com domain</p>
                {% endif %}
            </div>
        </div>
        <div class="modal-actions">
            <button class="btn-secondary" onclick="closeDeployModal()">Close</button>
        </div>
    </div>
</div>


<script src="{{ url_for('static', filename='js/particles.min.js') }}"></script>

<div id="keyboardShortcutsModal" class="modal">
    <div class="modal-content shortcuts-modal">
        <div class="modal-header">
            <h2><i class="fas fa-keyboard"></i> Keyboard Shortcuts</h2>
            <button class="close-btn" onclick="closeKeyboardShortcutsModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="shortcuts-list">
                <div class="shortcut-category">
                    <h4>Editor</h4>
                    <div class="shortcut-item">
                        <span>Save</span>
                        <span class="shortcut-key">Ctrl+S</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Undo</span>
                        <span class="shortcut-key">Ctrl+Z</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Redo</span>
                        <span class="shortcut-key">Ctrl+Y</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Fold Code</span>
                        <span class="shortcut-key">Alt+F</span>
                    </div>
                </div>
                <div class="shortcut-category">
                    <h4>Search</h4>
                    <div class="shortcut-item">
                        <span>Find</span>
                        <span class="shortcut-key">Ctrl+F</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Find Next</span>
                        <span class="shortcut-key">Ctrl+G</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Find Previous</span>
                        <span class="shortcut-key">Shift+Ctrl+G</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Replace</span>
                        <span class="shortcut-key">Ctrl+H</span>
                    </div>
                </div>
            </div>
            {% if site.site_type == 'python' %}
            <div class="shortcut-category">
                <h4>Python</h4>
                <div class="shortcut-item">
                    <span>Run Code</span>
                    <span class="shortcut-key">Ctrl+Enter</span>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>


<div id="orphy-widget" class="orphy-widget">
    <div class="orphy-container">
        <div class="orphy-header" id="orphy-header">
            <div class="orphy-title">
                <h2>Orphy <span class="orphy-emoji">🦖</span></h2>
            </div>
            <button class="orphy-close-btn" onclick="closeOrphyChat()">&times;</button>
        </div>
        <div class="orphy-chat">
            <div class="orphy-messages" id="orphyMessages"></div>
        </div>
        <div class="orphy-input">
            <textarea id="orphyInput" placeholder="Ask Orphy a question about your code..." rows="2"></textarea>
            <button class="orphy-send-btn" onclick="sendOrphyMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>

<!-- Include GitHub CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/github-buttons.css') }}">
<div id="tutorial-widget" style="display: none; position: fixed; width: 600px; max-width: 90%; height: auto; max-height: 80vh; background: white; border-radius: 12px; box-shadow: 0 5px 30px rgba(0, 0, 0, 0.2); z-index: 9999; opacity: 0; transition: opacity 0.3s ease; overflow: hidden;">
    <div class="orphy-header" style="background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%); cursor: grab; border-radius: 12px 12px 0 0;">
        <div class="orphy-title">
            <h2>Web Development Tutorial <span class="orphy-emoji">📚</span></h2>
        </div>
        <button class="orphy-close-btn" onclick="closeTutorialModal()">&times;</button>
    </div>
    <div style="overflow-y: auto; max-height: 70vh; background-color: white; padding: 20px; border-radius: 0 0 12px 12px;">
        <div class="tutorial-navigation" style="display: flex; justify-content: center; margin-bottom: 20px;">
            <button id="prev-tutorial" onclick="prevTutorialStep()" class="tutorial-nav-btn tutorial-prev-btn" disabled>
                <i class="fas fa-arrow-left"></i> Previous
            </button>
            <div class="tutorial-step-counter">
                <span id="tutorial-step-indicator">1/10</span>
            </div>
            <button id="next-tutorial" onclick="nextTutorialStep()" class="tutorial-nav-btn tutorial-next-btn">
                Next <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <div class="tutorial-content">
            <div class="tutorial-step" data-step="1" style="display: block;">
                <h3 style="color: #4e54c8; margin-top: 0;">Getting Started with HTML</h3>
                <p>HTML (HyperText Markup Language) is the backbone of any website. It defines the structure and content of your web page.</p>

                <div style="margin: 15px 0; background: #f8f9fa; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                    <h4 style="margin-top: 0;">Basic HTML Structure:</h4>
                    <pre style="background: #272822; color: #f8f8f2; padding: 10px; border-radius: 5px; overflow-x: auto;">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My First Website&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello World!&lt;/h1&gt;
    &lt;p&gt;This is my first web page.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
                </div>

                <p><strong>Try it:</strong> Type this structure into your editor to create a basic webpage.</p>
            </div>

            <div class="tutorial-step" data-step="2">
                <h3>Creating Your HTML File</h3>
                <p>Let's start by creating an HTML file called <code>index.html</code>. This will be the main page of your website and the entry point for browsers.</p>

                <div class="tutorial-info-box">
                    <p><strong>Why "index.html"?</strong> When you visit a website without specifying a file (like example.com), web servers automatically look for a file named "index.html" to display.</p>
                </div>

                <p>HTML documents have a specific structure with required elements:</p>

                <div class="tutorial-code-block">
                    <h4>Basic HTML Structure:</h4>
                    <pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;My First Website&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;Welcome to My Website&lt;/h1&gt;
        &lt;nav&gt;
            &lt;ul&gt;
                &lt;li&gt;&lt;a href="#home"&gt;Home&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href="#about"&gt;About&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href="#contact"&gt;Contact&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/nav&gt;
    &lt;/header&gt;

    &lt;main&gt;
        &lt;section id="home"&gt;
            &lt;h2&gt;Home Section&lt;/h2&gt;
            &lt;p&gt;This is the main content of my website. Welcome!&lt;/p&gt;
        &lt;/section&gt;

        &lt;section id="about"&gt;
            &lt;h2&gt;About Me&lt;/h2&gt;
            &lt;p&gt;I'm learning web development with HTML, CSS, and JavaScript.&lt;/p&gt;
        &lt;/section&gt;

        &lt;section id="contact"&gt;
            &lt;h2&gt;Contact Me&lt;/h2&gt;
            &lt;form id="contact-form"&gt;
                &lt;div&gt;
                    &lt;label for="name"&gt;Name:&lt;/label&gt;
                    &lt;input type="text" id="name" required&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;label for="email"&gt;Email:&lt;/label&gt;
                    &lt;input type="email" id="email" required&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;label for="message"&gt;Message:&lt;/label&gt;
                    &lt;textarea id="message" required&gt;&lt;/textarea&gt;
                &lt;/div&gt;
                &lt;button type="submit"&gt;Send Message&lt;/button&gt;
            &lt;/form&gt;
        &lt;/section&gt;
    &lt;/main&gt;

    &lt;footer&gt;
        &lt;p&gt;&copy; 2023 My Website. All rights reserved.&lt;/p&gt;
    &lt;/footer&gt;

    &lt;script src="script.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
                </div>

                <div class="tutorial-info-box">
                    <p><strong>Understanding the HTML Structure:</strong></p>
                    <ul>
                        <li><code>&lt;!DOCTYPE html&gt;</code>: Declares the document as HTML5</li>
                        <li><code>&lt;html lang="en"&gt;</code>: The root element with language attribute</li>
                        <li><code>&lt;head&gt;</code>: Contains metadata about the document</li>
                        <li><code>&lt;meta&gt;</code> tags: Provide information about character encoding and viewport settings</li>
                        <li><code>&lt;title&gt;</code>: Sets the page title shown in browser tabs</li>
                        <li><code>&lt;link&gt;</code>: Connects to external CSS file (we'll create this next)</li>
                        <li><code>&lt;body&gt;</code>: Contains the visible content of the page</li>
                        <li><code>&lt;script&gt;</code>: Links to our JavaScript file (we'll create this later)</li>
                    </ul>
                </div>

                <p>This HTML provides a basic structure with semantic elements like <code>&lt;header&gt;</code>, <code>&lt;nav&gt;</code>, <code>&lt;main&gt;</code>, <code>&lt;section&gt;</code>, and <code>&lt;footer&gt;</code> that help organize our content meaningfully.</p>

                <p><strong>Important:</strong> Create a new file named <code>index.html</code> and copy this code into it.</p>
            </div>

            <!-- Step 3: Creating the CSS File -->
            <div class="tutorial-step" data-step="3">
                <h3>Creating Your CSS File</h3>
                <p>Now let's create a CSS file to style our HTML. Create a new file called <code>styles.css</code> in the same folder as your HTML file.</p>

                <div class="tutorial-info-box">
                    <p><strong>CSS Fundamentals:</strong> CSS uses selectors to target HTML elements and apply styling properties to them. The basic syntax is <code>selector { property: value; }</code></p>
                </div>

                <div class="tutorial-code-block">
                    <h4>Basic CSS for Our Website:</h4>
                    <pre>/* Reset some default browser styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: #333;
    background-color: #f5f7fa;
}

/* Container layout */
header, main, footer {
    padding: 2rem;
    max-width: 1200px;
    margin: 0 auto;
}

/* Header and Navigation */
header {
    background-color: #4e54c8;
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 2rem;
}

nav ul {
    display: flex;
    list-style-type: none;
}

nav ul li {
    margin-left: 1.5rem;
}

nav ul li a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.3s;
}

nav ul li a:hover {
    color: #f0f0f0;
    text-decoration: underline;
}

/* Main content sections */
section {
    background-color: white;
    margin-bottom: 2rem;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

h1, h2 {
    margin-bottom: 1rem;
    color: #4e54c8;
}

p {
    margin-bottom: 1rem;
}

/* Form Styling */
#contact-form {
    display: grid;
    gap: 1rem;
    max-width: 500px;
}

#contact-form div {
    display: flex;
    flex-direction: column;
}

#contact-form label {
    margin-bottom: 0.5rem;
    font-weight: bold;
}

#contact-form input,
#contact-form textarea {
    padding: 0.8rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-family: inherit;
}

#contact-form textarea {
    height: 150px;
    resize: vertical;
}

#contact-form button {
    background-color: #4e54c8;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s;
}

#contact-form button:hover {
    background-color: #3f44b1;
}

/* Footer */
footer {
    text-align: center;
    color: #666;
    padding: 1rem;
    margin-top: 2rem;
    border-top: 1px solid #eee;
}

/* Responsive design for smaller screens */
@media (max-width: 768px) {
    header {
        flex-direction: column;
        text-align: center;
    }

    nav ul {
        margin-top: 1rem;
    }

    nav ul li {
        margin: 0 0.7rem;
    }
}</pre>
                </div>

                <div class="tutorial-info-box">
                    <p><strong>Key CSS Concepts Explained:</strong></p>
                    <ul>
                        <li><strong>Selectors:</strong> Target HTML elements by tag name(body), ID (#contact), class (.button), or other attributes</li>
                        <li><strong>Box Model:</strong> Every element has content, padding, border, and margin areas</li>
                        <li><strong>Display Properties:</strong> Control how elements are laid out (block, inline, flex, grid)</li>
                        <li><strong>Media Queries:</strong> Apply different styles based on screen size for responsive design</li>
                        <li><strong>Colors:</strong> Can be specified with names, hex codes (#4e54c8), RGB, or HSL values</li>
                    </ul>
                </div>

                <p><strong>Important:</strong> Create a new file named <code>styles.css</code> and copy this code into it.</p>
            </div>

            <!-- Step 4: Creating the JavaScript File -->
            <div class="tutorial-step" data-step="4">
                <h3>Creating Your JavaScript File</h3>
                <p>Finally, let's create a JavaScript file to add interactivity to our website. Create a new file called <code>script.js</code> in the same folder.</p>

                <div class="tutorial-info-box">
                    <p><strong>JavaScript Basics:</strong> JavaScript is a programming language that allows you to implement complex features on web pages—every time a page does more than just display static content, JavaScript is likely involved.</p>
                </div>

                <div class="tutorial-code-block">
                    <h4>JavaScript for Our Website:</h4>
                    <pre>// Wait for the DOM content to be fully loaded before running the code
document.addEventListener('DOMContentLoaded', function() {
    // Get references to elements we'll work with
    const contactForm = document.getElementById('contact-form');
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const messageInput = document.getElementById('message');

    // Function to handle smooth scrolling for navigation links
    function setupSmoothScrolling() {
        const navLinks = document.querySelectorAll('nav a');

        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                // Prevent default link behavior
                e.preventDefault();

                // Get the target section ID from the href attribute
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);

                // Scroll smoothly to the target section
                targetSection.scrollIntoView({ behavior: 'smooth' });
            });
        });
    }

    // Function to validate the contact form
    function validateContactForm(e) {
        // Prevent the form from submitting normally
        e.preventDefault();

        // Simple validation
        if (nameInput.value.trim() === '') {
            showMessage('Please enter your name', 'error');
            return;
        }

        if (emailInput.value.trim() === '') {
            showMessage('Please enter your email', 'error');
            return;
        }

        // Basic email validation
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailPattern.test(emailInput.value)) {
            showMessage('Please enter a valid email address', 'error');
            return;
        }

        if (messageInput.value.trim() === '') {
            showMessage('Please enter a message', 'error');
            return;
        }

        // If all validation passes, show success message
        showMessage('Your message has been sent successfully!', 'success');

        // Reset the form
        contactForm.reset();
    }

    // Function to show messages to the user
    function showMessage(text, type) {
        // Check if a message already exists and remove it
        const existingMessage = document.querySelector('.form-message');
        if (existingMessage) {
            existingMessage.remove();
        }

        // Create a new message element
        const messageElement = document.createElement('div');
        messageElement.className = `form-message ${type}`;
        messageElement.textContent = text;

        // Insert it after the form
        contactForm.parentNode.insertBefore(messageElement, contactForm.nextSibling);

        // Remove the message after 5 seconds
        setTimeout(() => {
            messageElement.remove();
        }, 5000);
    }

    // Add CSS for the form messages
    function addMessageStyles() {
        const style = document.createElement('style');
        style.textContent = `
            .form-message {
                margin-top: 1rem;
                padding: 0.75rem;
                border-radius: 4px;
            }
            .form-message.success {
                background-color: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }
            .form-message.error {
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
            }
        `;
        document.head.appendChild(style);
    }

    // Initialize all functionality
    function init() {
        setupSmoothScrolling();
        addMessageStyles();

        // Add event listener for form submission
        contactForm.addEventListener('submit', validateContactForm);

        console.log('Website JavaScript initialized');
    }

    // Run the initialization
    init();
});</pre>
                </div>

                <div class="tutorial-info-box">
                    <p><strong>Key JavaScript Concepts Explained:</strong></p>
                    <ul>
                        <li><strong>DOM Manipulation:</strong> JavaScript can access and change HTML elements on the page</li>
                        <li><strong>Event Listeners:</strong> Code that executes in response to user actions (clicks, form submissions)</li>
                        <li><strong>Functions:</strong> Reusable blocks of code that perform specific tasks</li>
                        <li><strong>Variables:</strong> Store data that can be used throughout your code</li>
                        <li><strong>Conditionals:</strong> Make decisions in code with if/else statements</li>
                        <li><strong>Regular Expressions:</strong> Patterns used for validating text (like email format)</li>
                    </ul>
                </div>

                <p><strong>Important:</strong> Create a new file named <code>script.js</code> and copy this code into it.</p>
            </div>

            <!-- Step 5: How Files Work Together -->
            <div class="tutorial-step" data-step="5">
                <h3>How These Files Work Together</h3>
                <p>Now that you've created your three files, let's understand how they work together to create a complete website:</p>

                <div class="file-creation-steps">
                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> index.html <span class="file-type-label file-type-html">Structure</span></h4>
                        <p>This is the foundation of your website. The browser loads this file first and uses it to understand the structure of your content.</p>
                        <p>Notice these key connections to the other files:</p>
                        <ul>
                            <li><code>&lt;link rel="stylesheet" href="styles.css"&gt;</code> — Tells the browser to load and apply your CSS file</li>
                            <li><code>&lt;script src="script.js"&gt;&lt;/script&gt;</code> — Tells the browser to load and execute your JavaScript file</li>
                        </ul>
                    </div>

                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> styles.css <span class="file-type-label file-type-css">Styling</span></h4>
                        <p>This file contains all your styling rules. CSS selectors target HTML elements by tag name, ID, or class.</p>
                        <p>For example:</p>
                        <ul>
                            <li><code>header { ... }</code> — Styles the <code>&lt;header&gt;</code> element</li>
                            <li><code>#contact-form { ... }</code> — Styles the element with <code>id="contact-form"</code></li>
                        </ul>
                    </div>

                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> script.js <span class="file-type-label file-type-js">Behavior</span></h4>
                        <p>This file adds interactivity to your site by:</p>
                        <ul>
                            <li>Finding elements with <code>document.getElementById('element-id')</code></li>
                            <li>Listening for events with <code>element.addEventListener('event', function)</code></li>
                            <li>Manipulating the page content in response to user actions</li>
                        </ul>
                    </div>
                </div>

                <div class="tutorial-info-box">
                    <p><strong>The Loading Process:</strong></p>
                    <ol>
                        <li>Browser receives request for your website</li>
                        <li>Loads and parses the HTML file first</li>
                        <li>Discovers CSS and JavaScript links in the HTML</li>
                        <li>Downloads and applies CSS styles</li>
                        <li>Downloads and executes JavaScript</li>
                        <li>JavaScript manipulates the DOM (HTML structure) as needed</li>
                    </ol>
                </div>
            </div>

            <!-- Additional steps (6-10) -->
            <div class="tutorial-step" data-step="6">
                <h3>Testing Your Website</h3>
                <p>Now that you have all three files created, it's time to test your website:</p>

                <ol>
                    <li>Make sure all three files (<code>index.html</code>, <code>styles.css</code>, and <code>script.js</code>) are in the same folder</li>
                    <li>Double-check that the filenames match exactly what's referenced in your HTML</li>
                    <li>Open the <code>index.html</code> file in your web browser</li>
                </ol>

                <div class="tutorial-info-box">
                    <p><strong>What to Check:</strong></p>
                    <ul>
                        <li>Are all the styles applying correctly? If not, check the CSS file path in your HTML.</li>
                        <li>Is the navigation working smoothly? If not, check the JavaScript console for errors.</li>
                        <li>Does the form validation work? Try submitting the form with empty fields or an invalid email.</li>
                    </ul>
                </div>

                <div class="tutorial-warning-box">
                    <p><strong>Troubleshooting:</strong> If something isn't working, right-click on your page and select "Inspect" or "Inspect Element" to open the browser's developer tools. Check the "Console" tab for JavaScript errors and the "Elements" tab to inspect your HTML and CSS.</p>
                </div>
            </div>

            <div class="tutorial-step" data-step="7">
                <h3>Understanding File Organization</h3>
                <p>For larger websites, organizing your files is crucial. Here's a common project structure used by professionals:</p>

                <div class="tutorial-code-block">
                    <h4>Professional Project Structure:</h4>
                    <pre>my-website/
|-- index.html
|-- about.html
|-- contact.html
|-- css/
|   |-- styles.css
|   |-- reset.css
|-- js/
|   |-- main.js
|   |-- validation.js
|-- images/
|   |-- logo.png
|   |-- banner.jpg
|-- fonts/
|   |-- custom-font.woff2</pre>
                </div>

                <p>Key benefits of this organization:</p>
                <ul>
                    <li><strong>Separation:</strong> Each type of file has its own directory</li>
                    <li><strong>Scalability:</strong> Easy to add more files as your project grows</li>
                    <li><strong>Maintenance:</strong> Easier to find what you're looking for</li>
                </ul>

                <div class="tutorial-info-box">
                    <p><strong>Path Updates:</strong> When using subdirectories, you'll need to update your file paths in HTML. For example:</p>
                    <ul>
                        <li><code>&lt;link rel="stylesheet" href="css/styles.css"&gt;</code></li>
                        <li><code>&lt;script src="js/main.js"&gt;&lt;/script&gt;</code></li>
                        <li><code>&lt;img src="images/logo.png" alt="Logo"&gt;</code></li>
                    </ul>
                </div>
            </div>

            <div class="tutorial-step" data-step="8">
                <h3>Extending Your Project</h3>
                <p>As your website grows, you'll want to maintain good organization. Here are some best practices:</p>

                <div class="file-creation-steps">
                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> HTML Best Practices</h4>
                        <ul>
                            <li>Use semantic HTML elements (<code>&lt;header&gt;</code>, <code>&lt;footer&gt;</code>, <code>&lt;article&gt;</code>) to give structure meaning</li>
                            <li>Maintain proper indentation for readability</li>
                            <li>Add comments for complex sections: <code>&lt;!-- Navigation Section --&gt;</code></li>
                            <li>Split large websites into multiple HTML pages (about.html, contact.html)</li>
                        </ul>
                    </div>

                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> CSS Best Practices</h4>
                        <ul>
                            <li>Group related styles together (navigation, forms, typography)</li>
                            <li>Use a CSS naming convention like BEM (Block Element Modifier)</li>
                            <li>Consider splitting large CSS files into components (navigation.css, forms.css)</li>
                            <li>Add comments to explain complex styling: <code>/* Mobile navigation styles */</code></li>
                        </ul>
                    </div>

                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> JavaScript Best Practices</h4>
                        <ul>
                            <li>Organize code into functions with specific purposes</li>
                            <li>Use descriptive variable and function names</li>
                            <li>Split large files into modules (form-validation.js, image-slider.js)</li>
                            <li>Add comments for complex logic: <code>// Calculate position based on scroll</code></li>
                        </ul>
                    </div>
                </div>

                <div class="tutorial-info-box">
                    <p><strong>Tip:</strong> For larger projects, consider using a build tool like Webpack or a framework like React, Vue, or Angular which help manage complex file structures.</p>
                </div>
            </div>

            <div class="tutorial-step" data-step="9">
                <h3>Debugging Your Code</h3>
                <p>When something isn't working as expected, debugging is an essential skill. Here are some debugging techniques for each file type:</p>

                <div class="file-creation-steps">
                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> HTML Debugging</h4>
                        <ul>
                            <li>Use the browser's "Inspect Element" tool to check your HTML structure</li>
                            <li>Validate your HTML with the W3C Validator (validator.w3.org)</li>
                            <li>Check for unclosed tags or improper nesting</li>
                            <li>Verify file paths for CSS, JavaScript, and image links</li>
                        </ul>
                    </div>

                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> CSS Debugging</h4>
                        <ul>
                            <li>Use the browser's developer tools to inspect applied styles</li>
                            <li>Check for typos in property names or selector syntax</li>
                            <li>Test specificity issues (when one style overrides another)</li>
                            <li>Try adding <code>border: 1px solid red;</code> to see element boundaries</li>
                        </ul>
                    </div>

                    <div class="file-creation-step">
                        <h4><i class="fas fa-file-code"></i> JavaScript Debugging</h4>
                        <ul>
                            <li>Use <code>console.log()</code> to print variable values at different points</li>
                            <li>Check the browser console for error messages</li>
                            <li>Set breakpoints in the developer tools to pause execution</li>
                            <li>Use <code>try/catch</code> blocks to handle potential errors</li>
                        </ul>
                    </div>
                </div>

                <div class="tutorial-warning-box">
                    <p><strong>Common Issues:</strong></p>
                    <ul>
                        <li><strong>CSS not applying:</strong> Check file paths, selector typos, or specificity issues</li>
                        <li><strong>JavaScript not working:</strong> Look for console errors, check if elements exist when you try to access them</li>
                        <li><strong>Layout problems:</strong> Inspect the box model (margins, padding, borders) in developer tools</li>
                    </ul>
                </div>
            </div>

            <div class="tutorial-step" data-step="10">
                <h3>Resources & Next Steps</h3>
                <p>Congratulations! You've created a complete website with separate HTML, CSS, and JavaScript files. Here are some resources to continue learning:</p>

                <div class="tutorial-code-block">
                    <h4>Learning Resources:</h4>
                    <ul>
                        <li><a href="https://developer.mozilla.org/en-US/" target="_blank">MDN Web Docs</a> - Comprehensive documentation for web technologies</li>
                        <li><a href="https://www.w3schools.com/" target="_blank">W3Schools</a> - Tutorials and references for beginners</li>
                        <li><a href="https://css-tricks.com/" target="_blank">CSS-Tricks</a> - Advanced CSS techniques and patterns</li>
                        <li><a href="https://javascript.info/" target="_blank">JavaScript.info</a> - Modern JavaScript tutorial</li>
                    </ul>
                </div>

                <p>Next steps to enhance your website:</p>
                <ol>
                    <li><strong>Add more pages</strong> - Create additional HTML files for different sections of your site</li>
                    <li><strong>Improve responsiveness</strong> - Refine your CSS for better mobile experience</li>
                    <li><strong>Add animations</strong> - Use CSS transitions or JavaScript libraries for animations</li>
                    <li><strong>Implement a CSS framework</strong> - Try Bootstrap, Tailwind CSS, or Bulma</li>
                    <li><strong>Learn a JavaScript framework</strong> - Explore React, Vue, or Angular for more complex sites</li>
                </ol>

                <div class="tutorial-info-box">
                    <p><strong>Pro Tip:</strong> The best way to learn is by building projects. Take what you've learned here and create your own website from scratch. Each project will teach you new skills and reinforce what you already know.</p>
                </div>

                <p>Remember that web development is a constantly evolving field. Keep learning, experimenting, and building to improve your skills!</p>
            </div>
        </div>
    </div>
</div>

<div id="ysws-widget">
    <div class="orphy-header" style="background: linear-gradient(135deg, #ff6b6b 0%, #8c52ff 100%); cursor: grab; border-radius: 12px 12px 0 0;">
        <div class="orphy-title">
            <h2>You Ship, We Ship <span class="orphy-emoji">🎁</span></h2>
        </div>
        <button class="orphy-close-btn" onclick="closeYSWSModal()">&times;</button>
    </div>
    <div style="overflow-y: auto; max-height: 70vh; background-color: white; padding: 20px; border-radius: 0 0 12px 12px;">
        <div class="ysws-section" style="margin-bottom: 30px; background: #f8f9fa; padding: 20px; border-radius: 12px; border-left: 4px solid #ff6b6b;">
            <h3 style="color: #ff6b6b; margin-top: 0;"><i class="fa-solid fa-mug-hot"></i> Boba Drops</h3>
            <p style="font-size: 16px; line-height: 1.5;">Ship a website, get $5 for Boba!</p>

            <div style="margin: 15px 0; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h4 style="margin-top: 0;">Requirements:</h4>
                <ul style="padding-left: 20px; line-height: 1.6;">
                    <li>You're a high schooler (or younger)</li>
                    <li>The website was made recently</li>
                    <li>Your website is a static site (uses HTML + CSS)</li>
                    <li>Your website has text, color and an image</li>
                    <li>You haven't gotten Boba Drops before</li>
                    <li>You are in the USA!</li>
                </ul>
            </div>

            <a href="https://forms.hackclub.com/t/tLf8GYVBqSus" target="_blank" class="btn-primary" style="display: inline-block; margin-top: 15px; text-decoration: none; padding: 10px 20px; background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%); color: white; border-radius: 8px; font-weight: bold; transition: all 0.2s ease;">
                <i class="fas fa-external-link-alt"></i> Apply for Boba Drops
            </a>
        </div>

        <div class="ysws-section" style="margin-bottom: 30px; background: #f8f9fa; padding: 20px; border-radius: 12px; border-left: 4px solid #8c52ff;">
            <h3 style="color: #8c52ff; margin-top: 0;"><i class="fa-solid fa-ice-cream"></i> Swirl</h3>
            <p style="font-size: 16px; line-height: 1.5;">Build a website, Get free ice cream!</p>

            <div style="margin: 15px 0; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h4 style="margin-top: 0;">Requirements:</h4>
                <ul style="padding-left: 20px; line-height: 1.6;">
                    <li>You're a high schooler (or younger)</li>
                    <li>The website was made recently</li>
                    <li>Your website is a static site (uses HTML + CSS)</li>
                    <li>Your website has text, color, and an image</li>
                    <li>Your website includes: 3 html pages, a favicon, at least 5 html tags</li>
                    <li>Your website contains at least one scoop</li>
                    <li>You haven't gotten a Swirl Grant before</li>
                    <li>If your website was submitted for Boba Drops, it has been expanded</li>
                    <li>Your website is original (NO AI or copy-pasting from ANYWHERE)</li>
                </ul>
            </div>

            <a href="https://forms.hackclub.com/t/t1UL6ZK4Nyus" target="_blank" class="btn-primary" style="display: inline-block; margin-top: 15px; text-decoration: none; padding: 10px 20px; background: linear-gradient(135deg, #8c52ff 0%, #a56fff 100%); color: white; border-radius: 8px; font-weight: bold; transition: all 0.2s ease;">
                <i class="fas fa-external-link-alt"></i> Apply for Swirl
            </a>
        </div>

        <div style="text-align: center; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 12px;">
            <h4 style="margin-top: 0; color: #ff9d00;"><i class="fas fa-lightbulb"></i> Quick Tip</h4>
            <p>Remember to save and deploy your site before applying. Good luck!</p>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/search.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/searchcursor.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/matchesonscrollbar.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/scroll/annotatescrollbar.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/match-highlighter.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/jump-to-line.min.js"></script>

{% if site.site_type == 'web' %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closetag.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/xml-hint.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/html-hint.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/brace-fold.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/xml-fold.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/comment-fold.min.js"></script>
<script src="{{ url_for('static', filename='js/github.js') }}"></script>
{% elif site.site_type == 'python' %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/python-hint.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/indent-fold.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/comment-fold.min.js"></script>
<script src="{{ url_for('static', filename='js/github.js') }}"></script>
{% endif %}

<script src="{{ url_for('static', filename='js/editor-core.js') }}"></script>
<script src="{{ url_for('static', filename='js/ui-utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/orphy.js') }}"></script>
<script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
<script src="{{ url_for('static', filename='js/file-handling.js') }}"></script>
{% if current_user.wakatime_api_key %}
<script src="{{ url_for('static', filename='js/hackatime-tracker.js') }}"></script>
{% endif %}

<script>
function openYSWSModal() {
    const widget = document.getElementById('ysws-widget');
    widget.style.display = 'block';

    // Center the modal initially
    const windowHeight = window.innerHeight;
    const windowWidth = window.innerWidth;
    const modalWidth = 500; // Fixed width
    const modalHeight = 600; // Approximate height

    widget.style.left = (windowWidth / 2 - modalWidth / 2) + 'px';
    widget.style.top = (windowHeight / 2 - modalHeight / 2) + 'px';
    widget.style.transform = 'none';

    setTimeout(() => {
        widget.style.opacity = '1';
    }, 50);

    const dragHandle = widget.querySelector('.orphy-header');
    makeDraggable(widget, dragHandle);
}

function openTutorialModal() {
    const widget = document.getElementById('tutorial-widget');
    widget.style.display = 'block';

    // Center the modal initially
    const windowHeight = window.innerHeight;
    const windowWidth = window.innerWidth;
    const modalWidth = 600; // Fixed width
    const modalHeight = 600; // Approximate height

    widget.style.left = (windowWidth / 2 - modalWidth / 2) + 'px';
    widget.style.top = (windowHeight / 2 - modalHeight / 2) + 'px';
    widget.style.transform = 'none';

    setTimeout(() => {
        widget.style.opacity = '1';
    }, 50);

    const dragHandle = widget.querySelector('.orphy-header');
    makeDraggable(widget, dragHandle);

    // Reset to first step
    currentTutorialStep = 1;
    updateTutorialStep();
}

function closeTutorialModal() {
    const widget = document.getElementById('tutorial-widget');
    widget.style.opacity = '0';
    setTimeout(() => {
        widget.style.display = 'none';
    }, 300);
}

let currentTutorialStep = 1;
const totalTutorialSteps = 10;

function nextTutorialStep() {
    if (currentTutorialStep < totalTutorialSteps) {
        currentTutorialStep++;
        updateTutorialStep();
    }
}

function prevTutorialStep() {
    if (currentTutorialStep > 1) {
        currentTutorialStep--;
        updateTutorialStep();
    }
}

function updateTutorialStep() {
    // Update step indicator
    document.getElementById('tutorial-step-indicator').textContent = `${currentTutorialStep}/${totalTutorialSteps}`;

    // Enable/disable navigation buttons
    document.getElementById('prev-tutorial').disabled = (currentTutorialStep === 1);
    document.getElementById('next-tutorial').disabled = (currentTutorialStep === totalTutorialSteps);

    // Show current step, hide others
    document.querySelectorAll('.tutorial-step').forEach(step => {
        const stepNum = parseInt(step.getAttribute('data-step'));
        step.style.display = (stepNum === currentTutorialStep) ? 'block' : 'none';
    });
}

function closeYSWSModal() {
    const widget = document.getElementById('ysws-widget');
    widget.style.opacity = '0';
    setTimeout(() => {
        widget.style.display = 'none';
    }, 300);
}

function makeDraggable(element, dragHandle) {
    let offsetX = 0, offsetY = 0;
    let isDragging = false;

    const startDrag = function(e) {
        isDragging = true;
        const rect = element.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
        dragHandle.style.cursor = 'grabbing';
        e.preventDefault();
    };

    const moveDrag = function(e) {
        if (!isDragging) return;

        const x = e.clientX - offsetX;
        const y = e.clientY - offsetY;

        // Set boundaries to keep the modal within viewport
        const maxX = window.innerWidth - element.offsetWidth;
        const maxY = window.innerHeight - element.offsetHeight;

        element.style.left = Math.min(Math.max(0, x), maxX) + 'px';
        element.style.top = Math.min(Math.max(0, y), maxY) + 'px';
        element.style.transform = 'none';
        e.preventDefault();
    };

    const endDrag = function() {
        isDragging = false;
        dragHandle.style.cursor = 'grab';
    };

    dragHandle.addEventListener('mousedown', startDrag);
    document.addEventListener('mousemove', moveDrag);
    document.addEventListener('mouseup', endDrag);
}
</script>

{% if additional_scripts %}
{{ additional_scripts|safe }}
{% endif %}
{% endblock %}