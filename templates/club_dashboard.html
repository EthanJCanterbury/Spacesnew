{% extends "base.html" %}

{% block content %}
<div class="club-dashboard-container">
    <!-- Sidebar Navigation -->
    <div class="club-sidebar">
        <div class="club-profile">
            <div class="profile-avatar">
                <i class="fas fa-users"></i>
            </div>
            <div class="profile-info">
                <h3>{% if club %}{{ club.name }}{% else %}Club Dashboard{% endif %}</h3>
                <span class="club-badge">{% if club and current_user.id == club.leader_id %}Club Leader{% elif club %}Member{% else %}No Club{% endif %}</span>
            </div>
        </div>

        <nav class="club-nav">
            <ul>
                <li>
                    <a href="#dashboard" class="nav-link active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>

<style>
    /* Button styles for modals */
    .modal-footer {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 10px;
        padding: 15px;
    }

    .btn-primary {
        background-color: #ec3750;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 10px 20px;
        font-weight: 500;
        cursor: pointer;
        display: inline-block;
        font-size: 14px;
        text-align: center;
        min-width: 120px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .btn-secondary {
        background-color: transparent;
        color: #333;
        border: none;
        padding: 10px 20px;
        font-weight: 500;
        cursor: pointer;
        display: inline-block;
        font-size: 14px;
        text-align: center;
    }

    /* System fonts only (to avoid CSP issues) */
    :root {
        --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        --font-mono: SFMono-Regular, Menlo, Monaco, Consolas, 'Courier New', monospace;
    }

    body, button, input, select, textarea {
        font-family: var(--font-sans);
    }

    code, pre {
        font-family: var(--font-mono);
    }

    /* Meeting styles */
    .meeting-item {
        background-color: #fff;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        border: 1px solid var(--border-color);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .meeting-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .meeting-item h3 {
        margin-top: 0;
        margin-bottom: 8px;
        color: var(--primary);
        font-size: 1.1rem;
    }

    .meeting-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 8px;
        font-size: 0.9rem;
        color: var(--text-secondary);
    }

    .meeting-meta span {
        display: flex;
        align-items: center;
    }

    .meeting-meta i {
        margin-right: 5px;
        width: 16px;
        color: var(--primary);
    }

    .meeting-actions {
        margin-top: 12px;
        display: flex;
        gap: 8px;
    }

    /* Event modal styling */
    .event-detail-row {
        margin-bottom: 16px;
    }

    .event-detail-label {
        font-weight: 500;
        margin-right: 8px;
        display: inline-block;
        width: 100px;
        color: #555;
    }

    .event-detail-label i {
        width: 16px;
        margin-right: 6px;
        color: #ec3750;
    }

    #eventModalDescription {
        margin-top: 8px;
        line-height: 1.5;
        color: #333;
    }
</style>

                <li>
                    <a href="#stream" class="nav-link" data-section="stream">
                        <i class="fas fa-stream"></i>
                        <span>Stream</span>
                    </a>
                </li>
                <li>
                    <a href="#assignments" class="nav-link" data-section="assignments">
                        <i class="fas fa-tasks"></i>
                        <span>Assignments</span>
                    </a>
                </li>
                <li>
                    <a href="#members" class="nav-link" data-section="members">
                        <i class="fas fa-user-friends"></i>
                        <span>Members</span>
                    </a>
                </li>
                <li>
                    <a href="#projects" class="nav-link" data-section="projects">
                        <i class="fas fa-code"></i>
                        <span>Spaces Projects</span>
                    </a>
                </li>
                <li>

<script>
    let currentEventId = null;

    function openEventModal(eventData) {
        try {
            currentEventId = eventData.eventId;
            const titleEl = document.getElementById('eventModalTitle');
            const dateEl = document.getElementById('eventDate');
            const timeEl = document.getElementById('eventTime');
            const locationEl = document.getElementById('eventLocation');
            const descriptionEl = document.getElementById('eventDescription');

            if (titleEl) titleEl.textContent = eventData.eventTitle;
            if (dateEl) dateEl.textContent = new Date(eventData.eventDate).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            if (timeEl) timeEl.textContent = eventData.eventTime;
            if (locationEl) locationEl.textContent = eventData.eventLocation;
            if (descriptionEl) descriptionEl.textContent = eventData.eventDescription;

            openModal('eventDetailsModal');
        } catch (error) {
            console.error('Error in openEventModal:', error);
            showToast('error', 'Failed to open event details');
        }
    }

    function closeEventModal() {
        closeModal('eventDetailsModal');
        currentEventId = null;
    }
    function formatDate(dateStr) {
        try {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        } catch (e) {
            return dateStr;
        }
    }
</script>


                    <a href="#resources" class="nav-link" data-section="resources">
                        <i class="fas fa-link"></i>
                        <span>Resources</span>
                    </a>
                </li>
                <li>
                    <a href="#schedule" class="nav-link" data-section="schedule">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Schedule</span>
                    </a>
                </li>
                <li>
                    <a href="#rewards" class="nav-link" data-section="rewards">
                        <i class="fas fa-gift"></i>
                        <span>Rewards</span>
                    </a>
                </li>
                {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                <li>
                    <a href="#hackatime" class="nav-link" data-section="hackatime">
                        <i class="fas fa-clock"></i>
                        <span>Hackatime</span>
                    </a>
                </li>
                {% endif %}
                <li>
                    <a href="#pizza" class="nav-link" data-section="pizza">
                        <i class="fas fa-pizza-slice"></i>
                        <span>Pizza Grants</span>
                    </a>
                </li>
                {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                <li>
                    <a href="#settings" class="nav-link" data-section="settings">
                        <i class="fas fa-cogs"></i>
                        <span>Settings</span>
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>

        <div class="club-sidebar-footer">
            <div class="sidebar-collapse-btn" id="sidebarCollapseBtn">
                <i class="fas fa-chevron-left"></i>
            </div>
            <a href="/logout" class="logout-link">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="club-content">
        <!-- Horizontal Navbar -->
        <div class="horizontal-navbar">
            <div class="navbar-title">
                <h1><i class="fas fa-users"></i> {% if club %}{{ club.name }}{% else %}Club Dashboard{% endif %}</h1>
            </div>
            <div class="navbar-actions">
                {% if club %}
                    {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                        <button class="btn-edit" onclick="openClubSettings()">
                            <i class="fas fa-edit"></i> Edit Club
                        </button>
                        <script>
                            function openClubSettings() {
                                // Switch to the settings tab
                                const settingsTab = document.querySelector('a[href="#settings"]');
                                if (settingsTab) {
                                    settingsTab.click();
                                } else {
                                    // Fallback if tab navigation doesn't work
                                    const settingsSection = document.getElementById('settings');
                                    if (settingsSection) {
                                        // Hide all sections
                                        document.querySelectorAll('.club-section').forEach(section => {
                                            section.classList.remove('active');
                                        });
                                        // Show settings section
                                        settingsSection.classList.add('active');
                                        // Update nav links
                                        document.querySelectorAll('.nav-link').forEach(link => {
                                            link.classList.remove('active');
                                        });
                                        document.querySelector('a[href="#settings"]').classList.add('active');
                                    }
                                }
                            }
                        </script>
                        <button class="btn-join-code" onclick="generateJoinCode()">
                            <i class="fas fa-key"></i> Join Code: <span id="join-code-display">{{ club.join_code }}</span>
                        </button>
                    {% else %}
                        <div class="club-info">
                            <span class="join-code-display-only"><i class="fas fa-users"></i> Member since: {{ current_user.club_memberships|selectattr('club_id', 'eq', club.id)|map(attribute='joined_at')|first|default('', true)|string|truncate(10, True, '') }}</span>
                        </div>
                    {% endif %}
                {% endif %}
            </div>
        </div>

        {% if not club %}
        <!-- Empty State -->
        <div class="club-empty-state">
            <div class="empty-icon">
                <i class="fas fa-users-slash"></i>
            </div>
            <h2>You haven't joined any clubs yet</h2>
            <p>Join an existing club with a join code or create your own!</p>
            <div class="empty-actions">
                <button class="btn-primary" onclick="openCreateClubModal()">
                    <i class="fas fa-plus"></i> Create Club
                </button>
                <button class="btn-secondary" onclick="openJoinClubModal()">
                    <i class="fas fa-sign-in-alt"></i> Join Club
                </button>
            </div>

            <script>
                function createClub() {
                    const clubName = document.getElementById('clubName').value;
                    const clubLocation = document.getElementById('clubLocation').value;
                    const clubDescription = document.getElementById('clubDescription').value;

                    if (!clubName) {



                        showToast('error', 'Please enter a club name');
                        return;
                    }

                    const clubData = {
                        name: clubName,
                        location: clubLocation, 
                        description: clubDescription
                    };

                    fetch('/api/clubs', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(clubData)
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            showToast('error', data.error);
                        } else {
                            showToast('success', 'Club created successfully!');
                            closeCreateClubModal();
                            // Redirect to the new club dashboard
                            window.location.href = `/club-dashboard/${data.club_id}`;
                        }
                    })
                    .catch(error => {
                        showToast('error', 'Failed to create club');
                        console.error('Error:', error);
                    });
                }

                function joinClub() {
                    const joinCode = document.getElementById('joinCode').value;

                    if (!joinCode) {
                        showToast('error', 'Please enter a join code');
                        return;
                    }

                    fetch('/api/clubs/join', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ join_code: joinCode })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            showToast('error', data.error);
                        } else {
                            showToast('success', 'Joined club successfully!');
                            closeJoinClubModal();
                            // Redirect to the club dashboard
                            window.location.href = `/club-dashboard/${data.club_id}`;
                        }
                    })
                    .catch(error => {
                        showToast('error', 'Failed to join club');
                        console.error('Error:', error);
                    });
                }
            </script>
        </div>

        {% elif current_user.club_memberships|length > 0 and not club %}
        <!-- Member View of Clubs -->
        <div class="my-clubs-section">
            <h2>My Clubs</h2>
            <div class="clubs-grid">
                {% for membership in current_user.club_memberships %}
                <div class="club-card" onclick="viewClub({{ membership.club.id }})">
                    <div class="club-card-header">
                        <h3>{{ membership.club.name }}</h3>
                        <span class="role-badge {% if membership.role == 'co-leader' %}role-badge-leader{% endif %}">
                            {{ membership.role|capitalize }}
                        </span>
                    </div>
                    <div class="club-card-body">
                        <p>{{ membership.club.description or 'No description available' }}</p>
                        <div class="club-meta">
                            <span><i class="fas fa-map-marker-alt"></i> {{ membership.club.location or 'No location' }}</span>
                            <span><i class="fas fa-user-friends"></i> {{ membership.club.members|length }} members</span>
                        </div>
                    </div>
                    <div class="club-card-footer">
                        <button class="btn-primary">View Club</button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% else %}

        <!-- Dashboard Section -->
        <section id="dashboard" class="club-section active">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
                <p style="text-align: center; width: 100%;">Welcome to {% if club %}{{ club.name }}{% else %}your club{% endif %}</p>
                <p class="club-subtitle" style="text-align: center; width: 100%;">Manage your hack club and empower your members with coding skills</p>
            </div>

            <div class="club-info-bar">
                <div class="club-code-box">
                    <span class="club-code-label"><i class="fas fa-key"></i> Join Code:</span>
                    <span class="club-code-value">{{ club.join_code }}</span>
                    <button class="refresh-code-btn" onclick="generateJoinCode()" title="Refresh Join Code">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>

            <div class="dashboard-card-grid">
                <!-- Club Members Card -->
                <div class="dashboard-feature-card">
                    <div class="card-icon member-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3>Club Members</h3>
                            <span class="card-subtitle">{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Manage Members{% else %}View Members{% endif %}</span>
                        </div>
                        <div class="card-metric">
                            <span class="metric-value">{{ club.members|length + 1 }}</span> total members
                        </div>
                        <p class="card-description">{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}View and manage all your club members{% else %}View club members{% endif %}</p>
                        <div class="card-action">
                            <a href="#members" class="btn-action" onclick="openTab('members')">
                                <i class="fas fa-{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}plus{% else %}users{% endif %}"></i> {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Add & View Members{% else %}View Members{% endif %}
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Club Meetings Card -->
                <div class="dashboard-feature-card">
                    <div class="card-icon meeting-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3>Club Meetings</h3>
                            <span class="card-subtitle">{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Schedule Meetings{% else %}View Meetings{% endif %}</span>
                        </div>
                        <p class="card-description">{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Planning your next club meeting{% else %}View upcoming club meetings{% endif %}</p>
                        <div class="card-action">
                            <a href="#schedule" class="btn-action" onclick="openTab('schedule')">
                                <i class="fas fa-{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}plus{% else %}calendar-alt{% endif %}"></i> {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Schedule Meeting{% else %}View Meetings{% endif %}
                            </a>
                        </div>
                    </div>
                </div>

                {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                <!-- Club Budget Card (Leaders Only) -->
                <div class="dashboard-feature-card">
                    <div class="card-icon budget-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3>Club Budget</h3>
                            <span class="card-subtitle">Manage Finances</span>
                        </div>
                        <p class="card-description">Track your club expenses and funding</p>
                        <div class="card-action">
                            <a href="#resources" class="btn-action" onclick="openTab('resources')">
                                <i class="fas fa-eye"></i> View Resources
                            </a>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Club Tasks Card -->
                <div class="dashboard-feature-card">
                    <div class="card-icon task-icon">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3>Club Tasks</h3>
                            <span class="card-subtitle">{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Manage Tasks{% else %}View Tasks{% endif %}</span>
                        </div>
                        <p class="card-description">{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Assign coding challenges to members{% else %}View assigned coding challenges{% endif %}</p>
                        <div class="card-action">
                            <a href="#assignments" class="btn-action" onclick="openTab('assignments')">
                                <i class="fas fa-{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}plus{% else %}list-ul{% endif %}"></i> {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Create Task{% else %}View Tasks{% endif %}
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Learning Pathways Card -->
                <div class="dashboard-feature-card">
                    <div class="card-icon pathway-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3>Learning Pathways</h3>
                            <span class="card-subtitle">Member Progress</span>
                        </div>
                        <p class="card-description">Track member coding project progress</p>
                        <div class="card-action">
                            <a href="#projects" class="btn-action" onclick="openTab('projects')">
                                <i class="fas fa-eye"></i> View Pathways
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Resources Card -->
                <div class="dashboard-feature-card">
                    <div class="card-icon resources-icon">
                        <i class="fas fa-book"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-header">
                            <h3>{% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}Leader Resources{% else %}Club Resources{% endif %}</h3>
                            <span class="card-subtitle">Hack Club Resources</span>
                        </div>
                        <p class="card-description">Access Hack Club workshops and resources</p>
                        <div class="card-action">
                            <a href="#resources" class="btn-action" onclick="openTab('resources')">
                                <i class="fas fa-link"></i> Access Resources
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-secondary-row">
                <div class="dashboard-card upcoming-meetings">
                    <div class="card-header">
                        <h3><i class="fas fa-calendar"></i> Upcoming Meetings</h3>
                        <a href="#schedule" class="card-link" onclick="openTab('schedule')">Schedule</a>
                    </div>
                    <div class="card-content" id="upcoming-meetings-mini">
                        <div class="loading-state">
                            <div class="loading-spinner"></div>
                            <p>Loading upcoming meetings...</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card active-assignments">
                    <div class="card-header">
                        <h3><i class="fas fa-clipboard-list"></i> Active Assignments</h3>
                        <a href="#assignments" class="card-link" onclick="openTab('assignments')">View All</a>
                    </div>
                    <div class="card-content" id="active-assignments-mini">
                        <div class="loading-state">
                            <div class="loading-spinner"></div>
                            <p>Loading active assignments...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hidden counters for dashboard stats -->
            <div style="display: none;">
                <span id="projectCount">0</span>
                <span id="assignmentCount">0</span>
            </div>

            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    // Load mini dashboards when the dashboard is active
                    loadMiniDashboards();
                });

                function loadMiniDashboards() {
                    try {
                        // Load upcoming meetings mini dashboard
                        fetch(`/api/clubs/{{ club.id }}/meetings?limit=2&upcoming=true`)
                        .then(response => response.json())
                        .then(data => {
                            const container = document.getElementById('upcoming-meetings-mini');
                            if (!container) return;

                        container.innerHTML = '';

                        if (data.meetings && data.meetings.length > 0) {
                            data.meetings.forEach(meeting => {
                                const meetingDate = new Date(meeting.meeting_date);
                                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                                const meetingEl = document.createElement('div');
                                meetingEl.className = 'upcoming-meeting';
                                meetingEl.innerHTML = `
                                    <div class="meeting-date">
                                        <span class="date-num">${meetingDate.getDate()}</span>
                                        <span class="date-month">${monthNames[meetingDate.getMonth()]}</span>
                                    </div>
                                    <div class="meeting-details">
                                        <h4>${meeting.title}</h4>
                                        <p><i class="fas fa-clock"></i> ${meeting.start_time}${meeting.end_time ? ` - ${meeting.end_time}` : ''}</p>
                                        <p><i class="fas fa-map-marker-alt"></i> ${meeting.location || 'No location set'}</p>
                                    </div>
                                `;
                                container.appendChild(meetingEl);
                            });
                        } else {
                            container.innerHTML = '<div class="empty-state">No upcoming meetings. <a href="#schedule" onclick="openTab(\'schedule\')">Schedule one!</a></div>';
                        }
                    })
                    .catch(error => {
                        console.error('Error loading meetings:', error);
                        const container = document.getElementById('upcoming-meetings-mini');
                        if (container) {
                            container.innerHTML = '<div class="error-state">Failed to load meetings.</div>';
                        }
                    });
                    } catch (err) {
                        console.log("Error loading mini dashboards:", err);
                    }

                    try {
                        // Load active assignments mini dashboard
                    fetch(`/api/clubs/{{ club.id }}/assignments?limit=2&active=true`)
                    .then(response => response.json())
                    .then(data => {
                        const container = document.getElementById('active-assignments-mini');
                        if (!container) return;

                        container.innerHTML = '';

                        if (data.assignments && data.assignments.length > 0) {
                            data.assignments.forEach(assignment => {
                                const assignmentEl = document.createElement('div');
                                assignmentEl.className = 'assignment-item';
                                assignmentEl.innerHTML = `
                                    <div class="assignment-status">
                                        <span class="status-badge status-active">Active</span>
                                    </div>
                                    <div class="assignment-details">
                                        <h4>${assignment.title}</h4>
                                        <p>${assignment.description.length > 80 ? assignment.description.substring(0, 80) + '...' : assignment.description}</p>
                                        <div class="assignment-meta">
                                            ${assignment.due_date ? 
                                            `<span><i class="fas fa-calendar-alt"></i> Due: ${new Date(assignment.due_date).toLocaleDateString()}</span>` : 
                                            '<span><i class="fas fa-infinity"></i> No due date</span>'}
                                        </div>
                                    </div>
                                `;
                                container.appendChild(assignmentEl);
                            });
                        } else {
                            container.innerHTML = '<div class="empty-state">No active assignments. <a href="#assignments" onclick="openTab(\'assignments\')">Create one!</a></div>';
                        }
                    })
                    .catch(error => {
                        console.error('Error loading assignments:', error);
                        const container = document.getElementById('active-assignments-mini');
                        if (container) {
                            container.innerHTML = '<div class="error-state">Failed to load assignments.</div>';
                        }
                    });
                    } catch (err) {
                        console.log("Error loading assignments dashboard:", err);
                    }
                }
            </script>

            <style>
                .club-subtitle {
                    color: #666;
                    margin-top: 0;
                    font-size: 0.9rem;
                    text-align: center;
                }

                .club-info-bar {
                    display: flex;
                    background-color: #f8f9fa;
                    padding: 15px;
                    border-radius: 8px;
                    margin-bottom: 24px;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                }

                .club-code-box {
                    display: flex;
                    align-items: center;
                }

                .club-code-label {
                    font-weight: 500;
                    margin-right: 10px;
                    color: #555;
                }

                .club-code-value {
                    background-color: #ec3750;
                    color: white;
                    padding: 3px 10px;
                    border-radius: 4px;
                    font-family: monospace;
                    font-weight: bold;
                    letter-spacing: 1px;
                }

                .refresh-code-btn {
                    background: none;
                    border: none;
                    color: #666;
                    cursor: pointer;
                    padding: 5px;
                    margin-left: 10px;
                    border-radius: 50%;
                    transition: all 0.2s;
                }

                .refresh-code-btn:hover {
                    background-color: #eee;
                    color: #ec3750;
                }

                .dashboard-card-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                    margin-bottom: 24px;
                }

                .dashboard-feature-card {
                    display: block;
                    background-color: white;
                    border-radius: 8px;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
                    overflow: hidden;
                    transition: transform 0.2s ease, box-shadow 0.2s ease;
                    height: 100%;
                    text-align: center;
                    padding: 20px;
                    border: 1px solid #f0f0f0;
                }

                .dashboard-feature-card:hover {
                    transform: translateY(-3px);
                    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
                }

                .dashboard-feature-card .card-icon {
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 24px;
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    margin-bottom: 15px;
                }

                .dashboard-feature-card .card-content {
                    text-align: center;
                }

                .dashboard-feature-card .card-header {
                    margin-bottom: 10px;
                    text-align: center;
                }

                .dashboard-feature-card .card-header h3 {
                    margin: 0;
                    font-size: 18px;
                    color: #333;
                    font-weight: 600;
                }

                .dashboard-feature-card .card-subtitle {
                    font-size: 12px;
                    color: #666;
                    display: block;
                }

                .dashboard-feature-card .card-metric {
                    margin-bottom: 10px;
                    font-size: 14px;
                    color: #555;
                }

                .dashboard-feature-card .metric-value {
                    font-weight: bold;
                    font-size: 20px;
                    color: #333;
                }

                .dashboard-feature-card .card-description {
                    font-size: 14px;
                    color: #666;
                    margin: 5px 0 16px;
                }

                .dashboard-feature-card .card-action {
                    margin-top: 15px;
                    text-align: center;
                }

                .dashboard-feature-card .btn-action {
                    display: inline-flex;
                    align-items: center;
                    padding: 8px 16px;
                    background-color: #f8f9fa;
                    color: #ec3750;
                    border-radius: 4px;
                    text-decoration: none;
                    font-size: 14px;
                    transition: background-color 0.2s;
                    border: 1px solid #f0f0f0;
                }

                .dashboard-feature-card .btn-action:hover {
                    background-color: #e0e0e0;
                }

                .dashboard-feature-card .btn-action i {
                    margin-right: 6px;
                }

                .dashboard-secondary-row {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 20px;
                }

                .dashboard-card {
                    background-color: white;
                    border-radius: 8px;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
                    overflow: hidden;
                }

                .dashboard-card .card-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 16px;
                    border-bottom: 1px solid #eee;
                }

                .dashboard-card .card-header h3 {
                    margin: 0;
                    font-size: 16px;
                    display: flex;
                    align-items: center;
                }

                .dashboard-card .card-header h3 i {
                    margin-right: 8px;
                    color: #ec3750;
                }

                .dashboard-card .card-link {
                    font-size: 14px;
                    color: #ec3750;
                    text-decoration: none;
                }

                .dashboard-card .card-link:hover {
                    text-decoration: underline;
                }

                .dashboard-card .card-content {
                    padding: 16px;
                }

                .empty-state {
                    text-align: center;
                    padding: 20px;
                    color: #666;
                    font-size: 14px;
                }

                .error-state {
                    text-align: center;
                    padding: 20px;
                    color: #d32f2f;
                    font-size: 14px;
                }

                .upcoming-meeting {
                    display: flex;
                    margin-bottom: 12px;
                    padding-bottom: 12px;
                    border-bottom: 1px solid #eee;
                }

                .upcoming-meeting:last-child {
                    margin-bottom: 0;
                    padding-bottom: 0;
                    border-bottom: none;
                }

                .meeting-date {
                    flex: 0 0 50px;
                    background-color: #ec3750;
                    color: white;
                    border-radius: 6px;
                    text-align: center;
                    margin-right: 12px;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    padding: 8px 0;
                }

                .date-num {
                    font-size: 18px;
                    font-weight: bold;
                }

                .date-month {
                    font-size: 12px;
                    text-transform: uppercase;
                }

                .meeting-details {
                    flex: 1;
                }

                .meeting-details h4 {
                    margin: 0 0 5px 0;
                    font-size: 16px;
                }

                .meeting-details p {
                    margin: 0 0 3px 0;
                    font-size: 12px;
                    color: #666;
                }

                .assignment-item {
                    display: flex;
                    margin-bottom: 12px;
                    padding-bottom: 12px;
                    border-bottom: 1px solid #eee;
                }

                .assignment-item:last-child {
                    margin-bottom: 0;
                    padding-bottom: 0;
                    border-bottom: none;
                }

                .assignment-status {
                    flex: 0 0 auto;
                    margin-right: 12px;
                }

                .status-badge {
                    display: inline-block;
                    padding: 3px 8px;
                    border-radius: 4px;
                    font-size: 12px;
                    font-weight: 500;
                }

                .status-active {
                    background-color: #e8f5e9;
                    color: #2e7d32;
                }

                .assignment-details {
                    flex: 1;
                }

                .assignment-details h4 {
                    margin: 0 0 5px 0;
                    font-size: 16px;
                }

                .assignment-details p {
                    margin: 0 0 8px 0;
                    font-size: 13px;
                    color: #666;
                }

                .assignment-meta {
                    font-size: 12px;
                    color: #888;
                }

                .assignment-meta span {
                    display: inline-flex;
                    align-items: center;
                }

                .assignment-meta i {
                    margin-right: 4px;
                }

                .loading-state {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                }

                .loading-spinner {
                    width: 24px;
                    height: 24px;
                    border: 3px solid rgba(236, 55, 80, 0.2);
                    border-radius: 50%;
                    border-top-color: #ec3750;
                    animation: spin 1s ease-in-out infinite;
                    margin-bottom: 10px;
                }

                @keyframes spin {
                    to { transform: rotate(360deg); }
                }
            </style>
        </section>

        <!-- Stream Tab Content -->
        <section id="stream" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-stream"></i> Stream</h2>
                <p style="text-align: center; width: 100%;">Announcements and updates for club members</p>
            </div>

            <div class="stream-container">
                <div class="post-composer">
                    <div class="composer-header">
                        <h3><i class="fas fa-pen"></i> Create Announcement</h3>
                    </div>
                    <div class="composer-body">
                        <textarea id="post-content" placeholder="Share an announcement with your club..."></textarea>
                        <div class="composer-actions">
                            <button class="btn-primary" onclick="createPost()">
                                <i class="fas fa-paper-plane"></i> Post
                            </button>
                    <script>
                        function createPost() {
                            const content = document.getElementById('post-content').value;
                            if (!content) {
                                showToast('error', 'Post content cannot be empty');
                                return;
                            }

                            fetch(`/api/clubs/{{ club.id }}/posts`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({ content: content })
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    showToast('success', 'Post created successfully');
                                    document.getElementById('post-content').value = '';
                                    loadPosts();
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to create post');
                                console.error('Error:', error);
                            });
                        }

                        function loadPosts() {
                            fetch(`/api/clubs/{{ club.id }}/posts`)
                            .then(response => response.json())
                            .then(data => {
                                const postsContainer = document.querySelector('.posts-list');
                                postsContainer.innerHTML = '';

                                if (data.posts && data.posts.length > 0) {
                                    data.posts.forEach(post => {
                                        const postElement = createPostElement(post);
                                        postsContainer.appendChild(postElement);
                                    });
                                } else {
                                    postsContainer.innerHTML = '<div class="empty-posts">No posts yet. Be the first to create a post!</div>';
                                }
                            })
                            .catch(error => {
                                console.error('Error loading posts:', error);
                            });
                        }

                        function createPostElement(post) {
                            const postCard = document.createElement('div');
                            postCard.className = 'post-card';
                            postCard.innerHTML = `
                                <div class="post-header">
                                    <img src="/static/images/logo-rounded.png" alt="Profile" class="avatar">
                                    <div class="post-info">
                                        <h3>${post.user.username}</h3>
                                        <span class="post-date">${formatDate(post.created_at)}</span>
                                    </div>
                                    <div class="post-actions">
                                        <button class="btn-icon"><i class="fas fa-ellipsis-v"></i></button>
                                    </div>
                                </div>
                                <div class="post-content">
                                    <p>${post.content}</p>
                                </div>
                                <div class="post-footer">
                                    <button class="post-action" onclick="toggleLike(${post.id})">
                                        <i class="${post.user_liked ? 'fas' : 'far'} fa-heart"></i> Like${post.likes > 0 ? ` (${post.likes})` : ''}
                                    </button>
                                </div>
                            `;
                            return postCard;
                        }

                        function formatDate(dateString) {
                            const date = new Date(dateString);
                            const now = new Date();
                            const diffTime = Math.abs(now - date);
                            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

                            if (diffDays === 0) {
                                const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
                                if (diffHours === 0) {
                                    const diffMinutes = Math.floor(diffTime / (1000 * 60));
                                    if (diffMinutes === 0) {
                                        return 'Just now';
                                    }
                                    return `${diffMinutes} minute${diffMinutes !== 1 ? 's' : ''} ago`;
                                }
                                return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;
                            } else if (diffDays === 1) {
                                return 'Yesterday';
                            } else if (diffDays < 7) {
                                return `${diffDays} days ago`;
                            } else {
                                return date.toLocaleDateString();
                            }
                        }

                        function toggleLike(postId) {
                            fetch(`/api/clubs/{{ club.id }}/posts/${postId}/like`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                }
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    loadPosts();
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to process like');
                                console.error('Error:', error);
                            });
                        }

                        // Load posts when the stream tab is shown
                        document.querySelector('a[data-section="stream"]').addEventListener('click', function() {
                            loadPosts();
                        });
                    </script>
                        </div>
                    </div>
                </div>

                <div class="posts-list">
                    <div class="post-card">
                        <div class="post-header">
                            <img src="{{ url_for('static', filename='images/logo-rounded.png') }}" alt="Profile" class="avatar">
                            <div class="post-info">
                                <h3>Club Leader</h3>
                                <span class="post-date">Just now</span>
                            </div>
                            <div class="post-actions">
                                <button class="btn-icon"><i class="fas fa-ellipsis-v"></i></button>
                            </div>
                        </div>
                        <div class="post-content">
                            <p>Welcome to our club! This is a sample announcement. Real announcements will appear here once you create them.</p>
                        </div>
                        <div class="post-footer">
                            <button class="post-action"><i class="far fa-heart"></i> Like</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Assignments Tab Content -->
        <section id="assignments" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-tasks"></i> Assignments</h2>
                <p style="text-align: center; width: 100%;">View and manage assignments for club members</p>
            </div>

            <div class="assignments-container">
                <div class="assignments-header">
                    <h3>Club Assignments</h3>
                    {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                    <button class="btn-primary" onclick="openCreateAssignmentModal()">
                        <i class="fas fa-plus"></i> New Assignment
                    </button>
                    {% endif %}
                </div>

                <div class="assignment-cards" id="assignments-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading assignments...</p>
                    </div>
                </div>

                <script>
                    function loadAssignments() {
                        const container = document.getElementById('assignments-container');
                        container.innerHTML = '<div class="loading-state"><div class="loading-spinner"></div><p>Loading assignments...</p></div>';

                        fetch(`/api/clubs/{{ club.id }}/assignments`)
                        .then(response => response.json())
                        .then(data => {
                            container.innerHTML = '';

                            if (data.assignments && data.assignments.length > 0) {
                                data.assignments.forEach(assignment => {
                                    const assignmentCard = createAssignmentCard(assignment);
                                    container.appendChild(assignmentCard);
                                });

                                // Update count on dashboard safely
                                const activeAssignments = data.assignments.filter(a => a.status === 'active').length;
                                try {
                                    const assignmentCountEl = document.getElementById('assignmentCount');
                                    if (assignmentCountEl) {
                                        assignmentCountEl.textContent = activeAssignments;
                                    }
                                } catch (err) {
                                    console.log("Assignment count element not available");
                                }
                            } else {
                                container.innerHTML = '<div class="empty-state">No assignments yet. Create your first assignment!</div>';
                                const assignmentCountEl = document.getElementById('assignmentCount');
                                if (assignmentCountEl) {
                                    assignmentCountEl.textContent = '0';
                                }
                            }
                        })
                        .catch(error => {
                            container.innerHTML = '<div class="error-state">Error loading assignments. Please try again.</div>';
                            console.error('Error loading assignments:', error);
                        });
                    }

                    function createAssignmentCard(assignment) {
                        const card = document.createElement('div');
                        card.className = 'assignment-card';

                        const statusClass = assignment.status === 'active' ? 'status-active' : 'status-completed';

                        card.innerHTML = `
                            <div class="assignment-status">
                                <span class="status-badge ${statusClass}">${assignment.status === 'active' ? 'Active' : 'Completed'}</span>
                            </div>
                            <div class="assignment-body">
                                <h3>${assignment.title}</h3>
                                <p>${assignment.description}</p>
                                <div class="assignment-meta">
                                    <span><i class="fas fa-calendar-alt"></i> Due: ${assignment.due_date ? new Date(assignment.due_date).toLocaleDateString() : 'No due date'}</span>
                                    <span><i class="fas fa-users"></i> For: ${assignment.for_all_members ? 'All members' : 'Selected members'}</span>
                                </div>
                            </div>
                            <div class="assignment-actions">
                                <button class="btn-primary btn-sm" onclick="viewAssignment(${assignment.id})"><i class="fas fa-eye"></i> View</button>
                                {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                                <button class="btn-secondary btn-sm" onclick="editAssignment(${assignment.id})"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn-danger btn-sm" onclick="deleteAssignment(${assignment.id})"><i class="fas fa-trash"></i></button>
                                {% endif %}
                            </div>
                        `;

                        return card;
                    }

                    function createAssignment() {
                        const title = document.getElementById('assignmentTitle').value;
                        const description = document.getElementById('assignmentDescription').value;
                        const dueDate = document.getElementById('assignmentDueDate').value;
                        const forAllMembers = document.getElementById('assignAllMembers').checked;

                        if (!title || !description) {
                            showToast('error', 'Please fill out all required fields');
                            return;
                        }

                        const assignmentData = {
                            title: title,
                            description: description,
                            due_date: dueDate,
                            for_all_members: forAllMembers
                        };

                        fetch(`/api/clubs/{{ club.id }}/assignments`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(assignmentData)
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.error) {
                                showToast('error', data.error);
                            } else {
                                showToast('success', 'Assignment created successfully');
                                closeCreateAssignmentModal();
                                loadAssignments();
                            }
                        })
                        .catch(error => {
                            showToast('error', 'Failed to create assignment');
                            console.error('Error:', error);
                        });
                    }

                    function viewAssignment(assignmentId) {
                        // Redirect to assignment details page or show details modal
                        showToast('info', 'View assignment functionality coming soon');
                    }

                    function editAssignment(assignmentId) {
                        // Open edit assignment modal
                        showToast('info', 'Edit assignment functionality coming soon');
                    }

                    function deleteAssignment(assignmentId) {
                        if (confirm('Are you sure you want to delete this assignment?')) {
                            fetch(`/api/clubs/{{ club.id }}/assignments/${assignmentId}`, {
                                method: 'DELETE'
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    showToast('success', 'Assignment deleted successfully');
                                    loadAssignments();
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to delete assignment');
                                console.error('Error:', error);
                            });
                        }
                    }

                    // Load assignments when the tab is shown
                    document.querySelector('a[data-section="assignments"]').addEventListener('click', function() {
                        loadAssignments();
                    });
                </script>
            </div>
        </section>

        <!-- Members Tab Content -->
        <section id="members" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-user-friends"></i> Members</h2>
                <p style="text-align: center; width: 100%;">Manage club members and their roles</p>
            </div>

            <div class="members-container">
                <div class="members-header">
                    <h3>Club Members</h3>
                    {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                    <button class="btn-primary" onclick="openAddMemberModal()">
                        <i class="fas fa-user-plus"></i> Add Member
                    </button>
                    {% endif %}
                    <script>
                        function generateJoinCode() {
                            fetch(`/api/clubs/{{ club.id }}/join-code`, {
                                method: 'POST'
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    document.getElementById('join-code-display').textContent = data.join_code;
                                    showToast('success', 'Join code generated successfully');
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to generate join code');
                                console.error('Error:', error);
                            });
                        }

                        function changeRole() {
                            const membershipId = document.getElementById('membershipIdForRole').value;
                            const newRole = document.querySelector('input[name="memberRole"]:checked').value;

                            fetch(`/api/memberships/${membershipId}/role`, {
                                method: 'PUT',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ role: newRole })
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    showToast('success', 'Role updated successfully');
                                    closeChangeRoleModal();
                                    window.location.reload(); // Refresh to show updated roles
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to update role');
                                console.error('Error:', error);
                            });
                        }

                        function openRemoveMemberModal(membershipId, username) {
                            if (confirm(`Are you sure you want to remove ${username} from the club?`)) {
                                fetch(`/api/memberships/${membershipId}/remove`, {
                                    method: 'POST'
                                })
                                .then(response => response.json())
                                .then(data => {
                                    if (data.error) {
                                        showToast('error', data.error);
                                    } else {
                                        showToast('success', data.message || 'Member removed successfully');
                                        window.location.reload(); // Refresh to update member list
                                    }
                                })
                                .catch(error => {
                                    showToast('error', 'Failed to remove member');
                                    console.error('Error:', error);
                                });
                            }
                        }
                    </script>
                </div>

                <div class="members-table-container">
                    <table class="members-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for membership in club.members %}
                                <tr>
                                    <td>{{ membership.user.username }}</td>
                                    <td>{{ membership.user.email }}</td>
                                    <td>
                                        <span class="role-badge {% if membership.role == 'co-leader' %}role-badge-leader{% endif %}">
                                            {{ membership.role|capitalize }}
                                        </span>
                                    </td>
                                    <td>{{ membership.joined_at.strftime('%Y-%m-%d') }}</td>
                                    <td>
                                        <div class="action-buttons">
                                            {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                                            <button class="btn-icon" onclick="openChangeRoleModal({{ membership.id }}, '{{ membership.user.username }}', '{{ membership.role }}')">
                                                <i class="fas fa-user-tag"></i>
                                            </button>
                                            <button class="btn-icon delete-action" onclick="openRemoveMemberModal({{ membership.id }}, '{{ membership.user.username }}')">
                                                <i class="fas fa-user-minus"></i>
                                            </button>
                                            {% endif %}
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Projects Tab Content -->
        <section id="projects" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-code"></i> Spaces Projects</h2>
                <p style="text-align: center; width: 100%;">Browse and showcase member projects</p>
            </div>

            <div class="projects-container">
                <div class="projects-header">
                    <h3>Club Member Projects</h3>
                    <div class="projects-actions">
                        <button class="btn-secondary btn-sm" id="toggle-featured">
                            <i class="fas fa-star"></i> Show Featured Only
                        </button>
                        <div class="search-box">
                            <input type="text" id="project-search" placeholder="Search projects...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                </div>

                <div class="projects-grid" id="projects-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading member projects...</p>
                    </div>
                </div>

                <style>
                    .projects-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                        gap: 20px;
                        margin-top: 20px;
                    }

                    .project-card {
                        background-color: white;
                        border-radius: 10px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                        overflow: hidden;
                        transition: transform 0.2s ease, box-shadow 0.2s ease;
                        display: flex;
                        flex-direction: column;
                        border: 1px solid #eee;
                    }

                    .project-card:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 6px 12px rgba(0,0,0,0.12);
                    }

                    .project-header {
                        padding: 15px;
                        border-bottom: 1px solid #f0f0f0;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    }

                    .project-header h3 {
                        margin: 0;
                        font-size: 18px;
                        font-weight: 600;
                        color: #333;
                    }

                    .featured-badge {
                        background-color: #fff4e6;
                        color: #ff9800;
                        font-size: 12px;
                        font-weight: 500;
                        padding: 4px 8px;
                        border-radius: 4px;
                        display: flex;
                        align-items: center;
                        gap: 4px;
                    }

                    .project-body {
                        padding: 15px;
                        flex: 1;
                    }

                    .project-body p {
                        margin: 0 0 15px;
                        color: #666;
                        font-size: 14px;
                    }

                    .project-meta {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 12px;
                        margin-bottom: 15px;
                        font-size: 13px;
                        color: #777;
                    }

                    .project-meta span {
                        display: flex;
                        align-items: center;
                        gap: 6px;
                    }

                    .project-meta i {
                        color: #ec3750;
                    }

                    .project-actions {
                        display: flex;
                        justify-content: space-between;
                        padding: 15px;
                        border-top: 1px solid #f0f0f0;
                        background-color: #fafafa;
                    }

                    .btn-sm {
                        padding: 6px 12px;
                        font-size: 13px;
                        font-weight: 500;
                    }

                    .view-button {
                        display: block;
                        text-align: center;
                        background-color: #ec3750;
                        color: white;
                        text-decoration: none;
                        padding: 8px 16px;
                        border-radius: 6px;
                        font-weight: 500;
                        font-size: 14px;
transition: background-color 0.2s;
                    }

                    .view-button:hover {
                        background-color: #c82d41;
                    }

                    .empty-projects {
                        text-align: center;
                        padding: 20px;
                        font-size: 14px;
                        color: #666;
                    }
                </style>

                <script>
                    function loadProjects() {
                        const container = document.getElementById('projects-container');
                        container.innerHTML = '<div class="loading-state"><div class="loading-spinner"></div><p>Loading member projects...</p></div>';

                        fetch(`/api/clubs/{{ club.id }}/projects`)
                        .then(response => response.json())
                        .then(data => {
                            container.innerHTML = '';
                            if (data.projects && data.projects.length > 0) {
                                data.projects.forEach(project => {
                                    const projectCard = createProjectCard(project);
                                    container.appendChild(projectCard);
                                });
                            } else {
                                container.innerHTML = '<div class="empty-projects">No projects yet. Be the first to create a project!</div>';
                            }
                        })
                        .catch(error => {
                            container.innerHTML = '<div class="error-state">Error loading projects. Please try again.</div>';
                            console.error('Error loading projects:', error);
                        });
                    }

                    function createProjectCard(project) {
                        const card = document.createElement('div');
                        card.className = 'project-card';

                        const projectTitle = project.title || 'Untitled Project';
                        const projectDescription = project.description || 'No description';

                        const projectMeta = `
                            <span><i class="fas fa-user"></i> ${project.user.username}</span>
                            ${project.featured ? `<span class="featured-badge"><i class="fas fa-star"></i> Featured</span>` : ''}
                        `;

                        card.innerHTML = `
                            <div class="project-header">
                                <h3>${projectTitle}</h3>
                                ${project.user.id === current_user.id ? `<button class="btn-icon"><i class="fas fa-ellipsis-v"></i></button>` : ''}
                            </div>
                            <div class="project-body">
                                <p>${projectDescription}</p>
                                <div class="project-meta">${projectMeta}</div>
                            </div>
                            <div class="project-actions">
                                <a href="/projects/${project.id}" class="view-button">View Project</a>
                            </div>
                        `;

                        return card;
                    }

                    document.addEventListener('DOMContentLoaded', function() {
                        loadProjects();

                        // Add event listener to search input
                        const searchInput = document.getElementById('project-search');
                        if (searchInput) {
                            searchInput.addEventListener('input', function() {
                                const searchTerm = this.value.toLowerCase();
                                const projectCards = document.querySelectorAll('.project-card');
                                projectCards.forEach(card => {
                                    const title = card.querySelector('h3').textContent.toLowerCase();
                                    const description = card.querySelector('p').textContent.toLowerCase();
                                    const username = card.querySelector('.project-meta').textContent.toLowerCase();

                                    if (title.includes(searchTerm) || description.includes(searchTerm) || username.includes(searchTerm)) {
                                        card.style.display = '';
                                    } else {
                                        card.style.display = 'none';
                                    }
                                });
                            });
                        }
                    });
                </script>
            </div>
        </section>

        <!-- Resources Tab Content -->
        <section id="resources" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-link"></i> Resources</h2>
                <p style="text-align: center; width: 100%;">Helpful resources for club members</p>
            </div>

            <div class="resources-container">
                <div class="resources-header">
                    <h3>Club Resources</h3>
                    {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                    <button class="btn-primary" onclick="openAddResourceModal()">
                        <i class="fas fa-plus"></i> Add Resource
                    </button>
                    {% endif %}
                </div>

                <div class="dashboard-card-grid" id="resources-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading resources...</p>
                    </div>
                </div>

                <script>
                    function loadResources() {
                        const container = document.getElementById('resources-container');
                        container.innerHTML = '<div class="loading-state"><div class="loading-spinner"></div><p>Loading resources...</p></div>';

                        fetch(`/api/clubs/{{ club.id }}/resources`)
                        .then(response => response.json())
                        .then(data => {
                            container.innerHTML = '';
                            if (data.resources && data.resources.length > 0) {
                                data.resources.forEach(resource => {
                                    const resourceCard = createResourceCard(resource);
                                    container.appendChild(resourceCard);
                                });
                            } else {
                                container.innerHTML = '<div class="empty-state">No resources yet. Add some useful resources!</div>';
                            }
                        })
                        .catch(error => {
                            container.innerHTML = '<div class="error-state">Error loading resources. Please try again.</div>';
                            console.error('Error loading resources:', error);
                        });
                    }

                    function createResourceCard(resource) {
                        const card = document.createElement('div');
                        card.className = 'resource-card';

                        card.innerHTML = `
                            <div class="resource-icon">
                                <i class="fas fa-link"></i>
                            </div>
                            <div class="resource-content">
                                <h3>${resource.title}</h3>
                                <p>${resource.description}</p>
                            </div>
                            <div class="resource-actions">
                                <a href="${resource.url}" target="_blank" class="btn-primary btn-sm">
                                    <i class="fas fa-external-link-alt"></i> Open
                                </a>
                                {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                                <button class="btn-secondary btn-sm" onclick="editResource(${resource.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn-danger btn-sm" onclick="deleteResource(${resource.id})">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                {% endif %}
                            </div>
                        `;

                        return card;
                    }

                    function createResource() {
                        const title = document.getElementById('resourceTitle').value;
                        const url = document.getElementById('resourceUrl').value;
                        const description = document.getElementById('resourceDescription').value;
                        if (!title || !url) {
                            showToast('error', 'Please fill out all required fields');
                            return;
                        }

                        const resourceData = {
                            title: title,
                            url: url,
                            description: description
                        };

                        fetch(`/api/clubs/{{ club.id }}/resources`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(resourceData)
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.error) {
                                showToast('error', data.error);
                            } else {
                                showToast('success', 'Resource created successfully');
                                closeAddResourceModal();
                                loadResources();
                            }
                        })
                        .catch(error => {
                            showToast('error', 'Failed to create resource');
                            console.error('Error:', error);
                        });
                    }

                    function editResource(resourceId) {
                        // Placeholder for edit resource functionality
                        showToast('info', 'Edit resource functionality coming soon');
                    }

                    function deleteResource(resourceId) {
                        if (confirm('Are you sure you want to delete this resource?')) {
                            fetch(`/api/clubs/{{ club.id }}/resources/${resourceId}`, {
                                method: 'DELETE'
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    showToast('success', 'Resource deleted successfully');
                                    loadResources();
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to delete resource');
                                console.error('Error:', error);
                            });
                        }
                    }

                    // Load resources when the tab is shown
                    document.querySelector('a[data-section="resources"]').addEventListener('click', function() {
                        loadResources();
                    });
                </script>
            </div>
        </section>

        <!-- Schedule Tab Content -->
        <section id="schedule" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-calendar-alt"></i> Schedule</h2>
                <p style="text-align: center; width: 100%;">View and manage club meetings</p>
            </div>

            <div class="schedule-container">
                <div class="schedule-header">
                    <h3>Club Meetings</h3>
                    {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                    <button class="btn-primary" onclick="openCreateMeetingModal()">
                        <i class="fas fa-plus"></i> Schedule Meeting
                    </button>
                    {% endif %}
                    <div class="filter-controls">
                        <select id="meetingFilter" class="form-select">
                            <option value="">All Meetings</option>
                            <option value="upcoming">Upcoming Meetings</option>
                            <option value="past">Past Meetings</option>
                        </select>
                    </div>
                </div>

                <div class="meetings-list-container" id="meetings-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading meetings...</p>
                    </div>
                </div>

                <script>
                    function loadMeetings() {
                        const container = document.getElementById('meetings-container');
                        container.innerHTML = '<div class="loading-state"><div class="loading-spinner"></div><p>Loading meetings...</p></div>';

                        fetch(`/api/clubs/{{ club.id }}/meetings`)
                        .then(response => response.json())
                        .then(data => {
                            container.innerHTML = '';
                            if (data.meetings && data.meetings.length > 0) {
                                const meetingsList = document.createElement('ul');
                                meetingsList.className = 'meetings-list';
                                data.meetings.forEach(meeting => {
                                    const meetingElement = createMeetingElement(meeting);
                                    meetingsList.appendChild(meetingElement);
                                });
                                container.appendChild(meetingsList);

                                // Update meeting count on dashboard safely
                                try {
                                    const meetingCountEl = document.getElementById('meetingCount');
                                    if (meetingCountEl) {
                                        meetingCountEl.textContent = data.meetings.length;
                                    }
                                } catch (err) {
                                    console.log("Meeting count element not available");
                                }
                            } else {
                                container.innerHTML = '<div class="meetings-list-empty">No meetings scheduled yet. Schedule one now!</div>';
                                try {
                                    const meetingCountEl = document.getElementById('meetingCount');
                                    if (meetingCountEl) {
                                        meetingCountEl.textContent = '0';
                                    }
                                } catch (err) {
                                    console.log("Meeting count element not available");
                                }
                            }
                        })
                        .catch(error => {
                            container.innerHTML = '<div class="error-state">Error loading meetings. Please try again.</div>';
                            console.error('Error loading meetings:', error);
                        });
                    }

                    function createMeetingElement(meeting) {
                        const li = document.createElement('li');
                        li.className = 'meeting-item';
                        li.innerHTML = `
                            <h3>${meeting.title}</h3>
                            <div class="meeting-meta">
                                <span><i class="fas fa-calendar-alt"></i> ${formatDate(meeting.meeting_date)}</span>
                                <span><i class="fas fa-clock"></i> ${meeting.start_time}${meeting.end_time ? ` - ${meeting.end_time}` : ''}</span>
                                <span><i class="fas fa-map-marker-alt"></i> ${meeting.location || 'No location set'}</span>
                            </div>
                            <div class="meeting-actions">
                                <button class="btn-primary btn-sm" onclick="viewMeeting(${meeting.id})"><i class="fas fa-eye"></i> View</button>
                                {% if current_user.id == club.leader_id or (club.members|selectattr('user_id', 'eq', current_user.id)|selectattr('role', 'eq', 'co-leader')|list|length > 0) %}
                                <button class="btn-secondary btn-sm" onclick="editMeeting(${meeting.id})"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn-danger btn-sm" onclick="deleteMeeting(${meeting.id})"><i class="fas fa-trash"></i> Delete</button>
                                {% endif %}
                            </div>
                        `;
                        return li;
                    }

                    function createMeeting() {
                        const title = document.getElementById('meetingTitle').value;
                        const date = document.getElementById('meetingDate').value;
                        const startTime = document.getElementById('startTime').value;
                        const endTime = document.getElementById('endTime').value;
                        const location = document.getElementById('meetingLocation').value;
                        const link = document.getElementById('meetingLink').value;
                        const description = document.getElementById('meetingDescription').value;

                        if (!title || !date || !startTime) {
                            showToast('error', 'Please fill out all required fields');
                            return;
                        }

                        const meetingData = {
                            title: title,
                            meeting_date: date,
                            start_time: startTime,
                            end_time: endTime,
                            location: location,
                            meeting_link: link,
                            description: description
                        };

                        fetch(`/api/clubs/{{ club.id }}/meetings`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(meetingData)
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.error) {
                                showToast('error', data.error);
                            } else {
                                showToast('success', 'Meeting created successfully');
                                closeCreateMeetingModal();
                                loadMeetings();
                            }
                        })
                        .catch(error => {
                            showToast('error', 'Failed to create meeting');
                            console.error('Error:', error);
                        });
                    }

                    function viewMeeting(meetingId) {
                        // Redirect to meeting details page or show details modal
                        showToast('info', 'View meeting functionality coming soon');
                    }

                    function editMeeting(meetingId) {
                        // Open edit meeting modal
                        fetch(`/api/clubs/{{ club.id }}/meetings/${meetingId}`)
                        .then(response => response.json())
                        .then(data => {
                            if (!data.meeting) {
                                showToast('error', 'Meeting not found');
                                return;
                            }
                            const meeting = data.meeting;
                            populateEditMeetingForm(meeting);
                            openModal('editMeetingModal');
                        })
                        .catch(error => {
                            showToast('error', 'Failed to load meeting data');
                            console.error('Error:', error);
                        });
                    }

                    function populateEditMeetingForm(meeting) {
                        document.getElementById('editMeetingId').value = meeting.id;
                        document.getElementById('editMeetingTitle').value = meeting.title;
                        document.getElementById('editMeetingDescription').value = meeting.description;
                        document.getElementById('editMeetingDate').value = meeting.meeting_date;
                        document.getElementById('editStartTime').value = meeting.start_time;
                        document.getElementById('editEndTime').value = meeting.end_time;
                        document.getElementById('editMeetingLocation').value = meeting.location;
                        document.getElementById('editMeetingLink').value = meeting.meeting_link;
                    }

                    function updateMeeting() {
                        const meetingId = document.getElementById('editMeetingId').value;
                        const title = document.getElementById('editMeetingTitle').value;
                        const description = document.getElementById('editMeetingDescription').value;
                        const date = document.getElementById('editMeetingDate').value;
                        const startTime = document.getElementById('editStartTime').value;
                        const endTime = document.getElementById('editEndTime').value;
                        const location = document.getElementById('editMeetingLocation').value;
                        const link = document.getElementById('editMeetingLink').value;

                        if (!title || !date || !startTime) {
                            showToast('error', 'Please fill out all required fields');
                            return;
                        }

                        const updatedMeetingData = {
                            title: title,
                            description: description,
                            meeting_date: date,
                            start_time: startTime,
                            end_time: endTime,
                            location: location,
                            meeting_link: link
                        };

                        fetch(`/api/clubs/{{ club.id }}/meetings/${meetingId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(updatedMeetingData)
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.error) {
                                showToast('error', data.error);
                            } else {
                                showToast('success', 'Meeting updated successfully');
                                closeModal('editMeetingModal');
                                loadMeetings();
                            }
                        })
                        .catch(error => {
                            showToast('error', 'Failed to update meeting');
                            console.error('Error:', error);
                        });
                    }

                    function deleteMeeting(meetingId) {
                        if (confirm('Are you sure you want to delete this meeting?')) {
                            fetch(`/api/clubs/{{ club.id }}/meetings/${meetingId}`, {
                                method: 'DELETE'
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.error) {
                                    showToast('error', data.error);
                                } else {
                                    showToast('success', 'Meeting deleted successfully');
                                    loadMeetings();
                                }
                            })
                            .catch(error => {
                                showToast('error', 'Failed to delete meeting');
                                console.error('Error:', error);
                            });
                        }
                    }

                    // Load meetings when the tab is shown
                    document.querySelector('a[data-section="schedule"]').addEventListener('click', function() {
                        loadMeetings();
                    });
                </script>

                <style>
                    .meetings-list-container {
                        background-color: white;
                        border-radius: 8px;
                        padding: 16px;
                        margin-bottom: 16px;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
                    }

                    .meetings-list {
                        list-style: none;
                        margin: 0;
                        padding: 0;
                    }

                    .meetings-list-empty {
                        text-align: center;
                        padding: 20px;
                        color: #666;
                        font-size: 14px;
                    }

                    .meeting-item {
                        background-color: white;
                        border-radius: 8px;
                        padding: 16px;
                        margin-bottom: 16px;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
                        border: 1px solid #eee;
                        transition: transform 0.2s ease, box-shadow 0.2s ease;
                        position: relative;
                    }

                    .meeting-item:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                    }

                    .meeting-item h3 {
                        margin-top: 0;
                        margin-bottom: 8px;
                        color: var(--primary);
                        font-size: 1.1rem;
                    }

                    .meeting-meta {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 12px;
                        margin-top: 8px;
                        font-size: 0.9rem;
                        color: var(--text-secondary);
                    }

                    .meeting-meta span {
                        display: flex;
                        align-items: center;
                    }

                    .meeting-meta i {
                        margin-right: 5px;
                        width: 16px;
                        color: var(--primary);
                    }

                    .meeting-actions {
                        margin-top: 12px;
                        display: flex;
                        gap: 8px;
                    }
                </style>
            </div>
        </section>

        <!-- Rewards Tab Content -->
        <section id="rewards" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-gift"></i> Rewards</h2>
                <p style="text-align: center; width: 100%;">View and claim rewards for club members</p>
            </div>

            <div class="rewards-container">
                <div class="rewards-header">
                    <h3>Club Rewards</h3>
                </div>

                <div class="rewards-grid" id="rewards-container">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading rewards...</p>
                    </div>
                </div>

                <script>
                    function loadRewards() {
                        const container = document.getElementById('rewards-container');
                        container.innerHTML = '<div class="loading-state"><div class="loading-spinner"></div><p>Loading rewards...</p></div>';

                        fetch(`/api/clubs/{{ club.id }}/rewards`)
                        .then(response => response.json())
                        .then(data => {
                            container.innerHTML = '';
                            if (data.rewards && data.rewards.length > 0) {
                                data.rewards.forEach(reward => {
                                    const rewardCard = createRewardCard(reward);
                                    container.appendChild(rewardCard);
                                });
                            } else {
                                container.innerHTML = '<div class="empty-state">No rewards yet. Add some exciting rewards!</div>';
                            }
                        })
                        .catch(error => {
                            container.innerHTML = '<div class="error-state">Error loading rewards. Please try again.</div>';
                            console.error('Error loading rewards:', error);
                        });
                    }

                    function createRewardCard(reward) {
                        const card = document.createElement('div');
                        card.className = 'reward-card';
                        card.innerHTML = `
                            <div class="reward-icon">
                                <i class="fas fa-gift"></i>
                            </div>
                            <div class="reward-content">
                                <h3>${reward.title}</h3>
                                <p>${reward.description}</p>
                                <div class="reward-meta">
                                    <span><i class="fas fa-trophy"></i> Points: ${reward.points}</span>
                                    <span><i class="fas fa-coins"></i> Cost: $${reward.cost}</span>
                                </div>
                            </div>
                            <div class="reward-actions">
                                <button class="btn-primary btn-sm" onclick="claimReward(${reward.id})">
                                    <i class="fas fa-check"></i> Claim
                                </button>
                            </div>
                        `;
                        return card;
                    }

                    function claimReward(rewardId) {
                        // Placeholder for claim reward functionality
                        showToast('info', 'Claim reward functionality coming soon');
                    }

                    // Load rewards when the tab is shown
                    document.querySelector('a[data-section="rewards"]').addEventListener('click', function() {
                        loadRewards();
                    });
                </script>

                <style>
                    .rewards-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                        gap: 20px;
                        margin-top: 20px;
                    }

                    .reward-card {
                        background-color: white;
                        border-radius: 10px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                        overflow: hidden;
                        transition: transform 0.2s ease, box-shadow 0.2s ease;
                        display: flex;
                        flex-direction: column;
                        border: 1px solid #eee;
                    }

                    .reward-card:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 6px 12px rgba(0,0,0,0.12);
                    }

                    .reward-icon {
                        flex: 0 0 50px;
                        background-color: #ec3750;
                        color: white;
                        border-radius: 6px;
                        text-align: center;
                        margin-right: 12px;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        padding: 8px 0;
                    }

                    .reward-icon i {
                        font-size: 24px;
                    }

                    .reward-content {
                        flex: 1;
                        padding: 15px;
                    }

                    .reward-content h3 {
                        margin: 0 0 5px;
                        font-size: 18px;
                        font-weight: 600;
                        color: #333;
                    }

                    .reward-content p {
                        margin: 0 0 10px;
                        color: #666;
                        font-size: 14px;
                    }

                    .reward-meta {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 12px;
                        margin-bottom: 15px;
                        font-size: 13px;
                        color: #777;
                    }

                    .reward-meta span {
                        display: flex;
                        align-items: center;
                        gap: 6px;
                    }

                    .reward-meta i {
                        color: #ec3750;
                    }

                    .reward-actions {
                        display: flex;
                        justify-content: flex-end;
                        padding: 15px;
                        border-top: 1px solid #f0f0f0;
                        background-color: #fafafa;
                    }

                    .btn-sm {
                        padding: 6px 12px;
                        font-size: 13px;
                        font-weight: 500;
                    }

                    .empty-state {
                        text-align: center;
                        padding: 20px;
                        font-size: 14px;
                        color: #666;
                    }
                </style>
            </div>
        </section>

        <!-- Hackatime Tab Content -->
        <section id="hackatime" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-clock"></i> Hackatime</h2>
                <p style="text-align: center; width: 100%;">Track coding time and earn rewards</p>
            </div>

            <div class="hackatime-container">
                <div class="hackatime-stats" id="hackatime-stats">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading Hackatime data...</p>
                    </div>
                </div>
                <script>
                    function loadHackatimeStats() {
                        const container = document.getElementById('hackatime-stats');
                        container.innerHTML = '<div class="loading-state"><div class="loading-spinner"></div><p>Loading Hackatime data...</p></div>';

                        fetch(`/api/clubs/{{ club.id }}/hackatime-stats`)
                        .then(response => response.json())
                        .then(data => {
                            container.innerHTML = '';
                            if (!data.error && data.stats) {
                                const stats = data.stats;
                                container.innerHTML = `
                                    <div class="stat-card">
                                        <h3>Total Coding Time</h3>
                                        <p>${stats.total_coding_time}</p>
                                    </div>
                                    <div class="stat-card">
                                        <h3>Coding Time This Week</h3>
                                        <p>${stats.coding_time_this_week}</p>
                                    </div>
                                    <div class="stat-card">
                                        <h3>Points Earned</h3>
                                        <p>${stats.points_earned}</p>
                                    </div>
                                `;
                            } else {
                                container.innerHTML = '<div class="empty-state">No Hackatime data yet. Start coding and earn points!</div>';
                            }
                        })
                        .catch(error => {
                            container.innerHTML = '<div class="error-state">Error loading Hackatime data. Please try again.</div>';
                            console.error('Error loading Hackatime data:', error);
                        });
                    }

                    document.querySelector('a[data-section="hackatime"]').addEventListener('click', function() {
                        loadHackatimeStats();
                    });
                </script>

                <style>
                    .hackatime-container {
                        display: flex;
                        flex-direction: column;
                        gap: 20px;
                        margin-top: 20px;
                    }

                    .stat-card {
                        background-color: white;
                        border-radius: 8px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                        padding: 20px;
                        text-align: center;
                        flex: 1;
                        border: 1px solid #eee;
                        transition: transform 0.2s ease, box-shadow 0.2s ease;
                        min-height: 120px;
                        height: 100%;
                    }

                    .stat-card:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 6px 12px rgba(0,0,0,0.12);
                    }

                    .stat-card h3 {
                        margin: 0 0 10px;
                        font-size: 16px;
                        font-weight: 600;
                        color: #333;
                    }

                    .stat-card p {
                        font-size: 20px;
                        font-weight: bold;
                        color: #ec3750;
                        margin-bottom: 5px;
                    }

                    .empty-state {
                        text-align: center;
                        padding: 20px;
                        font-size: 14px;
                        color: #666;
                    }
                </style>
            </div>
        </section>

        <!-- Pizza Grants Tab Content -->
        <section id="pizza" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-pizza-slice"></i> Pizza Grants</h2>
                <p style="text-align: center; width: 100%;">Apply for pizza grants for your coding projects</p>
            </div>

            <div class="pizza-container">
                <div class="pizza-grant-form" id="pizza-grant-form">
                    <div class="pizza-form-header">
                        <h3>Apply for a Pizza Grant</h3>
                    </div>

                    <form class="pizza-form" id="pizza-grant-form-data" action="/api/pizza-grants/submit" method="POST" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="project-select">Select Your Project</label>
                            <select id="project-select" class="form-input" required>
                                <option value="" disabled selected>Select your project</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="project-description">Project Description *</label>
                            <textarea id="project-description" class="form-textarea" rows="4" required></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group half">
                                <label for="project-url```">Project URL</label>
                                <input type="url" id="project-url" class="form-input" required>
                            </div>
                            <div class="form-group half">
                                <label for="project-cost">Estimated Cost *</label>
                                <input type="number" id="project-cost" class="form-input" min="0" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="project-members">Project Members *</label>
                            <textarea id="project-members" class="form-textarea" rows="3" required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="supporting-documents">Supporting Documents (Optional)</label>
                            <input type="file" id="supporting-documents" class="form-input" multiple>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn-primary">Submit Application</button>
                        </div>
                    </form>
                </div>
            </div>

            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    // Load projects into the project selection dropdown
                    loadProjectsForPizzaGrant();
                });

                function loadProjectsForPizzaGrant() {
                    fetch(`/api/clubs/{{ club.id }}/projects?active=true`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.projects && data.projects.length > 0) {
                            const select = document.getElementById('project-select');
                            data.projects.forEach(project => {
                                const option = document.createElement('option');
                                option.value = project.id;
                                option.text = project.title;
                                select.appendChild(option);
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Error loading projects:', error);
                    });
                }

                const pizzaGrantForm = document.getElementById('pizza-grant-form-data');
                pizzaGrantForm.addEventListener('submit', function(event) {
                    event.preventDefault();

                    const formData = new FormData(this);

                    fetch('/api/pizza-grants', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            showToast('error', data.error);
                        } else {
                            showToast('success', 'Pizza grant application submitted successfully!');
                            pizzaGrantForm.reset();
                            // Optionally, redirect to a thank you page or update the UI.
                        }
                    })
                    .catch(error => {
                        showToast('error', 'Failed to submit pizza grant application');
                        console.error('Error:', error);
                    });
                });
            </script>

            <style>
                .pizza-container {
                    display: flex;
                    flex-direction: column;
                    gap: 20px;
                    margin-top: 20px;
                }

                .pizza-grant-form {
                    background-color: white;
                    border-radius: 8px;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                    padding: 20px;
                    border: 1px solid #eee;
                    transition: transform 0.2s ease, box-shadow 0.2s ease;
                    min-height: 400px;
                    height: 100%;
                }

                .pizza-grant-form:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 6px 12px rgba(0,0,0,0.12);
                }

                .pizza-form-header {
                    text-align: center;
                    margin-bottom: 20px;
                }

                .pizza-form-header h3 {
                    margin: 0;
                    font-size: 20px;
                    font-weight: 600;
                    color: #333;
                }

                .form-group {
                    margin-bottom: 15px;
                }

                .form-group label {
                    display: block;
                    margin-bottom: 5px;
                    font-weight: 500;
                    color: #555;
                }

                .form-input {
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    font-size: 14px;
                    box-sizing: border-box;
                }

                .form-textarea {
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    font-size: 14px;
                    box-sizing: border-box;
                    resize: vertical;
                }

                .form-row {
                    display: flex;
                    gap: 15px;
                }

                .half {
                    flex: 1;
                }

                .form-actions {
                    text-align: center;
                    margin-top: 20px;
                }
            </style>
        </section>

        <!-- Settings Tab Content -->
        <section id="settings" class="club-section">
            <div class="section-header" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <h2 style="text-align: center;"><i class="fas fa-cogs"></i> Settings</h2>
                <p style="text-align: center; width: 100%;">Manage club settings and preferences</p>
            </div>

            <div class="settings-container">
                <form id="clubSettingsForm" action="/api/clubs/{{ club.id }}/update" method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="clubName">Club Name *</label>
                        <input type="text" id="clubName" name="clubName" value="{{ club.name }}" required>
                    </div>

                    <div class="form-group">
                        <label for="clubDescription">Club Description *</label>
                        <textarea id="clubDescription" name="clubDescription" rows="4" required>{{ club.description }}</textarea>
                    </div>

                    <div class="form-group">
                        <label for="clubLocation">Club Location *</label>
                        <input type="text" id="clubLocation" name="clubLocation" value="{{ club.location }}" required>
                    </div>

                    <div class="form-group">
                        <label for="clubImage">Club Image (Optional)</label>
                        <input type="file" id="clubImage" name="clubImage">
                        <img src="{{ club.image }}" alt="Club Image" style="max-width: 200px; margin-top: 10px;">
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
            <script>
                const clubSettingsForm = document.getElementById('clubSettingsForm');
                clubSettingsForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    const formData = new FormData(this);
                    fetch(this.action, {
                        method: 'PUT',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            showToast('error', data.error);
                        } else {
                            showToast('success', 'Club settings updated successfully!');
                        }
                    })
                    .catch(error => {
                        showToast('error', 'Failed to update club settings');
                        console.error('Error:', error);
                    });
                });
            </script>

            <style>
                .settings-container {
                    display: flex;
                    flex-direction: column;
                    gap: 20px;
                    margin-top: 20px;
                }

                .form-group {
                    margin-bottom: 15px;
                }

                .form-group label {
                    display: block;
                    margin-bottom: 5px;
                    font-weight: 500;
                    color: #555;
                }

                .form-input {
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    font-size: 14px;
                    box-sizing: border-box;
                }

                .form-textarea {
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    font-size: 14px;
                    box-sizing: border-box;
                    resize: vertical;
                }

                .form-actions {
                    text-align: center;
                    margin-top: 20px;
                }
            </style>
        </section>
    </div>
</div>

<div class="modal" id="eventDetailsModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Event Details</h3>
            <button class="close-btn" onclick="closeEventModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <div class="event-detail-row">
                <span class="event-detail-label"><i class="fas fa-calendar-alt"></i> Date:</span>
                <span id="eventDate"></span>
            </div>
            <div class="event-detail-row">
                <span class="event-detail-label"><i class="fas fa-clock"></i> Time:</span>
                <span id="eventTime"></span>
            </div>
            <div class="event-detail-row">
                <span class="event-detail-label"><i class="fas fa-map-marker-alt"></i> Location:</span>
                <span id="eventLocation"></span>
            </div>
            <div class="event-detail-row">
                <span class="event-detail-label"><i class="fas fa-pen"></i> Description:</span>
                <span id="eventDescription"></span>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeEventModal()">Close</button>
        </div>
    </div>
</div>

<div class="modal" id="changeRoleModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Change Member Role</h3>
            <button class="close-btn" onclick="closeChangeRoleModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="changeRoleForm">
                <input type="hidden" id="membershipIdForRole" value="">
                <div class="form-group">
                    <label for="memberRole">Select New Role</label>
                    <div class="role-options">
                        <label>
                            <input type="radio" name="memberRole" value="member"> Member
                        </label>
                        <label>
                            <input type="radio" name="memberRole" value="co-leader"> Co-Leader
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="changeRole()">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="createAssignmentModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Create New Assignment</h3>
            <button class="close-btn" onclick="closeCreateAssignmentModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="createAssignmentForm">
                <div class="form-group">
                    <label for="assignmentTitle">Assignment Title *</label>
                    <input type="text" id="assignmentTitle" required>
                </div>
                <div class="form-group">
                    <label for="assignmentDescription">Description *</label>
                    <textarea id="assignmentDescription" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="assignmentDueDate">Due Date</label>
                    <input type="date" id="assignmentDueDate">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="assignAllMembers"> Assign to All Members
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="createAssignment()">Create Assignment</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="addMemberModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Add New Member</h3>
            <button class="close-btn" onclick="closeAddMemberModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="addMemberForm">
                <div class="form-group">
                    <label for="memberUsername">Username *</label>
                    <input type="text" id="memberUsername" required>
                </div>
                <div class="form-group">
                    <label for="memberEmail">Email *</label>
                    <input type="email" id="memberEmail" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="addMember()">Add Member</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="createClubModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Create New Club</h3>
            <button class="close-btn" onclick="closeCreateClubModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="createClubForm">
                <div class="form-group">
                    <label for="clubName">Club Name *</label>
                    <input type="text" id="clubName" required>
                </div>
                <div class="form-group">
                    <label for="clubLocation">Location *</label>
                    <input type="text" id="clubLocation" required>
                </div>
                <div class="form-group">
                    <label for="clubDescription">Description *</label>
                    <textarea id="clubDescription" rows="4" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="createClub()">Create Club</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="joinClubModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Join Existing Club</h3>
            <button class="close-btn" onclick="closeJoinClubModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="joinClubForm">
                <div class="form-group">
                    <label for="joinCode">Join Code *</label>
                    <input type="text" id="joinCode" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="joinClub()">Join Club</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="createMeetingModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Schedule New Meeting</h3>
            <button class="close-btn" onclick="closeCreateMeetingModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="createMeetingForm">
                <div class="form-group">
                    <label for="meetingTitle">Meeting Title *</label>
                    <input type="text" id="meetingTitle" required>
                </div>
                <div class="form-group">
                    <label for="meetingDescription">Description</label>
                    <textarea id="meetingDescription" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="meetingDate">Date *</label>
                    <input type="date" id="meetingDate" required>
                </div>
                <div class="form-group">
                    <label for="startTime">Start Time *</label>
                    <input type="time" id="startTime" required>
                </div>
                <div class="form-group">
                    <label for="endTime">End Time</label>
                    <input type="time" id="endTime">
                </div>
                <div class="form-group">
                    <label for="meetingLocation">Location</label>
                    <input type="text" id="meetingLocation">
                </div>
                <div class="form-group">
                    <label for="meetingLink">Meeting Link</label>
                    <input type="url" id="meetingLink">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="createMeeting()">Create Meeting</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="editMeetingModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Edit Meeting</h3>
            <button class="close-btn" onclick="closeModal('editMeetingModal')"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="editMeetingForm">
                <input type="hidden" id="editMeetingId">
                <div class="form-group">
                    <label for="editMeetingTitle">Meeting Title *</label>
                    <input type="text" id="editMeetingTitle" required>
                </div>
                <div class="form-group">
                    <label for="editMeetingDescription">Description</label>
                    <textarea id="editMeetingDescription" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="editMeetingDate">Date *</label>
                    <input type="date" id="editMeetingDate" required>
                </div>
                <div class="form-group">
                    <label for="editStartTime">Start Time *</label>
                    <input type="time" id="editStartTime" required>
                </div>
                <div class="form-group">
                    <label for="editEndTime">End Time</label>
                    <input type="time" id="editEndTime">
                </div>
                <div class="form-group">
                    <label for="editMeetingLocation">Location</label>
                    <input type="text" id="editMeetingLocation">
                </div>
                <div class="form-group">
                    <label for="editMeetingLink">Meeting Link</label>
                    <input type="url" id="editMeetingLink">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="updateMeeting()">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal" id="addResourceModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Add New Resource</h3>
            <button class="close-btn" onclick="closeAddResourceModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="addResourceForm">
                <div class="form-group">
                    <label for="resourceTitle">Resource Title *</label>
                    <input type="text" id="resourceTitle" required>
                </div>
                <div class="form-group">
                    <label for="resourceUrl">URL *</label>
                    <input type="url" id="resourceUrl" required>
                </div>
                <div class="form-group">
                    <label for="resourceDescription">Description</label>
                    <textarea id="resourceDescription" rows="4"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="createResource()">Add Resource</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Function to open a modal
    function openModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'block';
    }

    // Function to close a modal
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'none';
    }

    // Function to show toast notification
    function showToast(type, message) {
        const toastContainer = document.getElementById('toastContainer');
        if (!toastContainer) {
            return;
        }

        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.innerHTML = message;
        toastContainer.appendChild(toast);

        setTimeout(function() {
            toast.remove();
        }, 3000); // Remove after 3 seconds
    }

    // Event listener for sidebar collapse button
    const sidebarCollapseBtn = document.getElementById('sidebarCollapseBtn');
    sidebarCollapseBtn.addEventListener('click', function() {
        const sidebar = document.querySelector('.club-sidebar');
        sidebar.classList.toggle('collapsed');
    });

    function openTab(tabId) {
        const activeSection = document.querySelector('.club-section.active');
        activeSection.classList.remove('active');
        const newSection = document.getElementById(tabId);
        newSection.classList.add('active');
        // Update navigation
        const activeNavLink = document.querySelector('.nav-link.active');
        if (activeNavLink) {
            activeNavLink.classList.remove('active');
        }
        const newNavLink = document.querySelector(`a[data-section="${tabId}"]`);
        if (newNavLink) {
            newNavLink.classList.add('active');
        }
    }

    function openChangeRoleModal(membershipId, username, currentRole) {
        const modal = document.getElementById('changeRoleModal');
        const membershipIdInput = document.getElementById('membershipIdForRole');
        const radioButtons = modal.querySelectorAll('input[name="memberRole"]');

        membershipIdInput.value = membershipId;
        radioButtons.forEach(radioButton => {
            if (radioButton.value === currentRole) {
                radioButton.checked = true;
            }
        });
        openModal('changeRoleModal');
    }

    function closeChangeRoleModal() {
        closeModal('changeRoleModal');
    }

    function openCreateClubModal() {
        openModal('createClubModal');
    }

    function closeCreateClubModal() {
        closeModal('createClubModal');
    }

    function openJoinClubModal() {
        openModal('joinClubModal');
    }

    function closeJoinClubModal() {
        closeModal('joinClubModal');
    }

    function openCreateMeetingModal() {
        openModal('createMeetingModal');
    }

    function closeCreateMeetingModal() {
        closeModal('createMeetingModal');
    }

    function openCreateAssignmentModal() {
        openModal('createAssignmentModal');
    }

    function closeCreateAssignmentModal() {
        closeModal('createAssignmentModal');
    }

    function openAddMemberModal() {
        openModal('addMemberModal');
    }

    function closeAddMemberModal() {
        closeModal('addMemberModal');
    }

    function openAddResourceModal() {
        openModal('addResourceModal');
    }

    function closeAddResourceModal() {
        closeModal('addResourceModal');
    }

    // Add more functions as needed for other modals

    document.addEventListener('DOMContentLoaded', function() {
        // Check if the sidebar should be collapsed (based on screen size)
        const sidebar = document.querySelector('.club-sidebar');
        if (window.innerWidth < 768) {
            sidebar.classList.add('collapsed');
        } else {
            sidebar.classList.remove('collapsed');
        }

        // Add event listener to window resize event
        window.addEventListener('resize', function() {
            const sidebar = document.querySelector('.club-sidebar');
            if (window.innerWidth < 768) {
                sidebar.classList.add('collapsed');
            } else {
                sidebar.classList.remove('collapsed');
            }
        });

        const meetingFilter = document.getElementById('meetingFilter');
        meetingFilter.addEventListener('change', function() {
            loadMeetings();
        });
    });
</script>

<div id="toastContainer"></div>

{% endblock %}